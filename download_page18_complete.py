import os
import urllib.request
import urllib.parse
import ssl

DOWNLOAD_DIR = "/Users/mingsaksaengwilaipon/.gemini/antigravity/scratch/gprocurement_downloads"

# Page 18 links (Corrected list - 20 items)
page_18_links = [
    "https://www.gprocurement.go.th/wps/wcm/connect/9c923f6e-c29d-4f6a-b000-ecbf55c28e30/01_%E0%B8%81%E0%B8%A7%E0%B8%88_36836_260864_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B9%83%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9E%E0%B8%B4%E0%B8%88%E0%B8%B2%E0%B8%A3%E0%B8%93%E0%B8%B2%E0%B8%84%E0%B8%B8%E0%B8%93%E0%B8%AA%E0%B8%A1%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%BAF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-9c923f6e-c29d-4f6a-b000-ecbf55c28e30-nOhrJjj",
    "https://www.gprocurement.go.th/wps/wcm/connect/d3d56af4-d8c7-4ba2-9c94-2837090ac711/02_%E0%B8%81%E0%B8%A7%E0%B8%88_36701_260864_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%8B%E0%B8%B7%E0%B9%89%E0%B8%AD%E0%B8%A7%E0%B8%B1%E0%B8%84%E0%B8%8B%E0%B8%B5%E0%B8%99%E0%B9%82%E0%B8%84%E0%B8%A7%E0%B8%B4%E0%B8%94+19.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-d3d56af4-d8c7-4ba2-9c94-2837090ac711-nOo1KO4",
    "https://www.gprocurement.go.th/wps/wcm/connect/8a17e0ed-db36-42ca-9c2d-e4f63ca64c54/01_%E0%B8%81%E0%B8%A7%E0%B8%88_36377_240864_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%A3%E0%B8%93%E0%B8%B5%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%80%E0%B8%A3%E0%B8%B5%E0%B8%A2%E0%B8%81%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B8%9B%E0%B8%A3%E0%B8%B1%E0%B8%9B%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2%E0%B8%8B%E0%B8%B7%E0%B9%89%E0%B8%AD%E0%B8%82%E0%B8%B2%E0%B8%A2.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-8a17e0ed-db36-42ca-9c2d-e4f63ca64c54-nOnvTwg",
    "https://www.gprocurement.go.th/wps/wcm/connect/09505ed2-f170-48c3-8b19-5c501f456807/02_%E0%B8%81%E0%B8%A7%E0%B8%88_35045_180864_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B3%E0%B8%93%E0%B8%B5%E0%B8%82%E0%B8%AD%E0%B9%80%E0%B8%9A%E0%B8%B4%E0%B8%81%E0%B9%80%E0%B8%87%E0%B8%B4%E0%B8%99%E0%B8%A5%E0%B9%88%E0%B8%A7%E0%B8%87%E0%B8%AB%E0%B8%99%E0%B9%89%E0%B8%B2+15%25+%E0%B8%AB%E0%B8%A5%E0%B8%B1%E0%B8%87%E0%B8%88%E0%B8%B2%E0%B8%81%E0%B9%82%E0%B8%AD%E0%B8%99%E0%B8%AA%E0%B8%B4%E0%B8%97%E0%B8%98%E0%B8%B4%E0%B9%80%E0%B8%A3%E0%B8%B5%E0%B8%A2%E0%B8%81%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%87.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-09505ed2-f170-48c3-8b19-5c501f456807-nXyQxcK",
    "https://www.gprocurement.go.th/wps/wcm/connect/23e94d5e-7dbd-4042-852d-58e0a96cf5ef/04_%E0%B8%81%E0%B8%A7%E0%B8%88_34864_170864_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%9B%E0%B8%9F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B9%80%E0%B8%81%E0%B8%B5%E0%B9%88%E0%B8%A2%E0%B8%A7%E0%B8%81%E0%B8%B1%E0%B8%9A%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9E%E0%B8%B4%E0%B8%88%E0%B8%B2%E0%B8%A3%E0%B8%93%E0%B8%B2%E0%B8%87%E0%B8%94%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%A5%E0%B8%94%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B8%9B%E0%B8%A3%E0%B8%B1%E0%B8%9A%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-23e94d5e-7dbd-4042-852d-58e0a96cf5ef-nT1.Grs",
    "https://www.gprocurement.go.th/wps/wcm/connect/8428f9c8-6348-4fc5-921a-52662f040fcf/01_%E0%B8%81%E0%B8%A7%E0%B8%88_34863_170864_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B3%E0%B8%A3%E0%B8%B5%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%81%E0%B8%81%E0%B9%89%E0%B9%84%E0%B8%82%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%8B%E0%B9%88%E0%B8%AD%E0%B8%A1%E0%B9%81%E0%B8%8B%E0%B8%A1%E0%B8%84%E0%B8%A7%E0%B8%B2%E0%B8%A1%E0%B8%8A%E0%B8%B3%E0%B8%A3%E0%B8%B8%E0%B8%94%E0%B8%9A%E0%B8%81%E0%B8%9E%E0%B8%A3%E0%B9%88%E0%B8%AD%E0%B8%87%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-8428f9c8-6348-4fc5-921a-52662f040fcf-nOo0Vzq",
    "https://www.gprocurement.go.th/wps/wcm/connect/1da91c41-523c-4d88-92bb-b44da9de7483/02_%E0%B8%81%E0%B8%A7%E0%B8%88_34855_170864_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%81%E0%B8%B3%E0%B8%AB%E0%B8%99%E0%B8%94%E0%B9%80%E0%B8%87%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B9%84%E0%B8%82%E0%B9%83%E0%B8%99%E0%B9%80%E0%B8%AD%E0%B8%81%E0%B8%AA%E0%B8%B2%E0%B8%A3%E0%B9%80%E0%B8%8A%E0%B8%B4%E0%B8%8D%E0%B8%8A%E0%B8%A7%E0%B8%99%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-1da91c41-523c-4d88-92bb-b44da9de7483-nPake-D",
    "https://www.gprocurement.go.th/wps/wcm/connect/6ed6ca23-b7e1-48f3-baa6-7e9cc6b150cc/03_%E0%B8%81%E0%B8%A7%E0%B8%88_34849_170864_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%A7%E0%B8%B4%E0%B8%88%E0%B8%B2%E0%B8%A3%E0%B8%93%E0%B9%8C%E0%B8%A3%E0%B9%88%E0%B8%B2%E0%B8%87%E0%B9%80%E0%B8%AD%E0%B8%81%E0%B8%AA%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%A3%E0%B8%B0%E0%B8%81%E0%B8%A7%E0%B8%94%E0%B8%A3%E0%B8%B2%E0%B8%84%E0%B8%B2%E0%B8%8B%E0%B8%B7%E0%B9%89%E0%B8%AD%E0%B8%A3%E0%B8%96%E0%B8%9A%E0%B8%A3%E0%B8%A3%E0%B8%97%E0%B8%B8%E0%B8%81%E0%B8%82%E0%B8%A2%E0%B8%B0+%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-6ed6ca23-b7e1-48f3-baa6-7e9cc6b150cc-nPaP5k7",
    "https://www.gprocurement.go.th/wps/wcm/connect/67cae3dc-2921-4678-a967-898d020f1957/03_%E0%B8%81%E0%B8%A7%E0%B8%88_33891_090864_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%9B%E0%B8%9F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B9%83%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%81%E0%B8%88%E0%B9%89%E0%B8%87%E0%B8%A2%E0%B8%81%E0%B9%80%E0%B8%A5%E0%B8%B4%E0%B8%81%E0%B8%9B%E0%B8%A3%E0%B8%B0%E0%B8%81%E0%B8%B2%E0%B8%A9%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-67cae3dc-2921-4678-a967-898d020f1957-nTm9bph",
    "https://www.gprocurement.go.th/wps/wcm/connect/627d2016-717d-4755-8a7f-f3c443388800/01_%E0%B8%81%E0%B8%A7%E0%B8%88_33888_090864_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%A3%E0%B8%93%E0%B8%B5%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%81%E0%B9%8D%E0%B8%B2%E0%B8%AB%E0%B8%99%E0%B8%94%E0%B9%80%E0%B8%87%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%99%E0%B9%84%E0%B8%82%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-627d2016-717d-4755-8a7f-f3c443388800-nT7xSkJ",
    "https://www.gprocurement.go.th/wps/wcm/connect/a3bf9275-b229-4577-9650-2d0a29df555d/02_%E0%B8%81%E0%B8%A7%E0%B8%88_33886_090864_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%A1%E0%B8%95%E0%B8%B4%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-a3bf9275-b229-4577-9650-2d0a29df555d-nT7CZpK",
    "https://www.gprocurement.go.th/wps/wcm/connect/2d8c00cd-c085-48d8-a522-07444fc4c4d1/04_%E0%B8%81%E0%B8%A7%E0%B8%88_33872_090864_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%9B%E0%B8%BF%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B9%80%E0%B8%81%E0%B8%B5%E0%B9%88%E0%B8%A2%E0%B8%A7%E0%B8%81%E0%B8%B1%E0%B8%9A%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%AD%E0%B8%AD%E0%B8%81%E0%B9%81%E0%B8%9A%E0%B8%9A%E0%B8%81%E0%B9%88%E0%B8%AD%E0%B8%AA%E0%B8%A3%E0%B9%89%E0%B8%B2%E0%B8%87.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-2d8c00cd-c085-48d8-a522-07444fc4c4d1-nTmbir.",
    "https://www.gprocurement.go.th/wps/wcm/connect/b92e44dc-ca13-4ba9-82d7-46db9e803196/01_%E0%B8%81%E0%B8%A7%E0%B8%88_33431_040864_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%95%E0%B8%A3%E0%B8%A7%E0%B8%88%E0%B8%A3%E0%B8%B1%E0%B8%9A%E0%B8%84%E0%B8%A3%E0%B8%B8%E0%B8%A0%E0%B8%B1%E0%B8%93%E0%B8%91%E0%B9%8C%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-b92e44dc-ca13-4ba9-82d7-46db9e803196-nOhzTGs",
    "https://www.gprocurement.go.th/wps/wcm/connect/089f8043-187f-408e-ad92-31210ac6d334/01_%E0%B8%81%E0%B8%A7%E0%B8%88_33345_030864_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%95%E0%B8%A3%E0%B8%A7%E0%B8%88%E0%B8%A3%E0%B8%B1%E0%B8%9A%E0%B8%9E%E0%B8%B1%E0%B8%AA%E0%B8%94%E0%B8%B8%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2%E0%B8%88%E0%B9%82%E0%B8%84%E0%B8%A3%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-089f8043-187f-408e-ad92-31210ac6d334-nT7GZRQ",
    "https://www.gprocurement.go.th/wps/wcm/connect/cfa7adbf-841b-4a64-a691-e84b4a21a97f/01_%E0%B8%81%E0%B8%A7%E0%B8%88_33186_020864_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9E%E0%B8%A5%E0%B8%B1%E0%B8%87%E0%B8%87%E0%B8%B2%E0%B8%99%E0%B9%84%E0%B8%9F%E0%B8%9F%E0%B9%89%E0%B8%B2%E0%B8%94%E0%B9%89%E0%B8%A7%E0%B8%A2%E0%B8%A3%E0%B8%B0%E0%B8%9A%E0%B8%9A%E0%B8%9C%E0%B8%A5%E0%B8%B4%E0%B8%95%E0%B9%84%E0%B8%9F%E0%B8%9F%E0%B9%89%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-cfa7adbf-841b-4a64-a691-e84b4a21a97f-nXyNQK4",
    "https://www.gprocurement.go.th/wps/wcm/connect/43d785d0-0bde-477d-9885-2f41935cc10a/01_%E0%B8%81%E0%B8%A7%E0%B8%88_32690_290764_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B9%83%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9E%E0%B8%B4%E0%B8%88%E0%B8%B2%E0%B8%A3%E0%B8%93%E0%B8%B2%E0%B8%84%E0%B8%B8%E0%B8%93%E0%B8%AA%E0%B8%A1%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%BAF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-43d785d0-0bde-477d-9885-2f41935cc10a-nOhrf6.",
    "https://www.gprocurement.go.th/wps/wcm/connect/ad1880ab-9b3d-46be-8869-ea95a2ca0ee4/01_%E0%B8%81%E0%B8%A7%E0%B8%88_32617_270764_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%80%E0%B8%A3%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9A%E0%B8%A3%E0%B8%B4%E0%B8%AB%E0%B8%B2%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-ad1880ab-9b3d-46be-8869-ea95a2ca0ee4-nOhGzY-",
    "https://www.gprocurement.go.th/wps/wcm/connect/3d14f74e-992f-46a0-8fb4-9dccc6a9a552/02_%E0%B8%81%E0%B8%A7%E0%B8%88_32616_270764_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%81%E0%B8%95%E0%B9%88%E0%B8%87%E0%B8%95%E0%B8%B1%E0%B9%89%E0%B8%87%E0%B8%84%E0%B8%93%E0%B8%B0%E0%B8%81%E0%B8%A3%E0%B8%A3%E0%B8%A1%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%AB%E0%B8%B2%E0%B8%B7%E0%B8%AD%E0%B9%80%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%AB%E0%B8%99%E0%B9%89%E0%B8%B2%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-3d14f74e-992f-46a0-8fb4-9dccc6a9a552-nPqmu6P",
    "https://www.gprocurement.go.th/wps/wcm/connect/4ef362dc-6471-4b74-b4d4-a6d57837ebed/02_%E0%B8%81%E0%B8%A7%E0%B8%88_31969_190764_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%84%E0%B8%B4%E0%B8%94%E0%B9%88%E0%B8%B2%E0%B8%9B%E0%B8%A3%E0%B8%B1%E0%B8%9A%E0%B8%9C%E0%B8%B4%E0%B8%94%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2%E0%B9%81%E0%B8%A5%E0%B9%81%E0%B8%88%E0%B9%89%E0%B8%87%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B8%9C%E0%B8%B9%E0%B9%82%E0%B8%82%E0%B8%B2%E0%B8%A2%E0%B9%80%E0%B8%9B%E0%B9%87%E0%B8%99%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B8%97%E0%B8%B4%E0%B9%89%E0%B8%87%E0%B8%87%E0%B8%B2%E0%B8%99.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-4ef362dc-6471-4b74-b4d4-a6d57837ebed-nOnqM-7",
    "https://www.gprocurement.go.th/wps/wcm/connect/c7cbc843-9e81-4610-83eb-d00ffc2f6496/01_%E0%B8%81%E0%B8%A7%E0%B8%88_31965_190764_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9E%E0%B8%B4%E0%B8%88%E0%B8%B2%E0%B8%A3%E0%B8%93%E0%B8%B2%E0%B8%84%E0%B8%B8%E0%B8%93%E0%B8%AA%E0%B8%A1%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B9%81%E0%B8%A5%E0%B8%B0%E0%B8%9C%E0%B8%A5%E0%B8%87%E0%B8%B2%E0%B8%99%E0%B8%82%E0%B8%AD%E0%B8%87%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B8%A2%E0%B8%B7%E0%B9%88%E0%B8%99%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B9%80%E0%B8%AA%E0%B8%99%E0%B8%AD%E0%B8%A3%E0%B8%B2%E0%B8%84%E0%B8%B2.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-c7cbc843-9e81-4610-83eb-d00ffc2f6496-nOno8YD"
]

ctx = ssl.create_default_context()
ctx.check_hostname = False
ctx.verify_mode = ssl.CERT_NONE

print(f"Downloading {len(page_18_links)} files from Page 18 (Correct Batch)...")

success = 0
failed = 0
for url in page_18_links:
    try:
        path = urllib.parse.urlparse(url).path
        filename_encoded = os.path.basename(path)
        filename = urllib.parse.unquote(filename_encoded)
        
        # Simple sanitization
        filename = filename.replace('\ufe6f', '').replace('%EF%B9%AF', '')
        
        filepath = os.path.join(DOWNLOAD_DIR, filename)
        
        if os.path.exists(filepath):
            print(f"Skip (exists): {filename[:40]}...")
            success += 1
            continue
            
        print(f"DL: {filename[:40]}...")
        req = urllib.request.Request(url, headers={'User-Agent': 'Mozilla/5.0'})
        with urllib.request.urlopen(req, context=ctx, timeout=30) as r, open(filepath, 'wb') as f:
            f.write(r.read())
        success += 1
    except Exception as e:
        print(f"Failed: {filename[:30]}... - {e}")
        failed += 1

print(f"\nPage 18 (Correct Batch) done. Success: {success}, Failed: {failed}")
print()
print("Counting total files in download directory...")
files = [f for f in os.listdir(DOWNLOAD_DIR) if f.endswith('.pdf')]
print(f"Total PDF files: {len(files)}")
