import os
import urllib.request
import urllib.parse
import ssl

DOWNLOAD_DIR = "/Users/mingsaksaengwilaipon/.gemini/antigravity/scratch/gprocurement_downloads"

page_10_links = [
  "https://www.gprocurement.go.th/wps/wcm/connect/f15ab375-08ca-42f0-bae4-09ac6957fe67/001_%E0%B8%81%E0%B8%A7%E0%B8%88_59767_271264_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%81%E0%B8%8E%E0%B8%81%E0%B8%A3%E0%B8%B0%E0%B8%97%E0%B8%A3%E0%B8%A7%E0%B8%87%E0%B8%AF+PDPA.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-f15ab375-08ca-42f0-bae4-09ac6957fe67-p8ey7Kg",
  "https://www.gprocurement.go.th/wps/wcm/connect/3520911d-50d5-4041-8175-e164d44a3ae7/03_%E0%B8%81%E0%B8%A7%E0%B8%88_59178_221264_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%A1%E0%B8%B2%E0%B8%95%E0%B8%A3%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B8%84%E0%B8%A7%E0%B8%B2%E0%B8%A1%E0%B8%8A%E0%B9%88%E0%B8%A7%E0%B8%A2%E0%B9%80%E0%B8%AB%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-3520911d-50d5-4041-8175-e164d44a3ae7-nT.OKak",
  "https://www.gprocurement.go.th/wps/wcm/connect/872b0c38-23c1-4344-a960-80684d35b2ae/02_%E0%B8%81%E0%B8%A7%E0%B8%88_59172_221264_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%A1%E0%B8%B2%E0%B8%95%E0%B8%A3%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B8%84%E0%B8%A7%E0%B8%B2%E0%B8%A1%E0%B8%8A%E0%B9%88%E0%B8%A7%E0%B8%A2%E0%B9%80%E0%B8%AB%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B8%9B%E0%B8%A3%E0%B8%B0%E0%B8%81%E0%B8%AD%E0%B8%9A%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-872b0c38-23c1-4344-a960-80684d35b2ae-nT.MXFA",
  "https://www.gprocurement.go.th/wps/wcm/connect/168a5a9c-96f2-4a03-93c4-8c1197eb3d7c/01_%E0%B8%81%E0%B8%A7%E0%B8%88_59148_221264_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%A1%E0%B8%B2%E0%B8%95%E0%B8%A3%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B8%84%E0%B8%A7%E0%B8%B2%E0%B8%A1%E0%B8%8A%E0%B9%88%E0%B8%A7%E0%B8%A2%E0%B9%80%E0%B8%AB%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B8%9B%E0%B8%A3%E0%B8%B0%E0%B8%81%E0%B8%AD%E0%B8%9A%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-168a5a9c-96f2-4a03-93c4-8c1197eb3d7c-nT.J2Cc",
  "https://www.gprocurement.go.th/wps/wcm/connect/ddd62534-4618-4e58-b90f-a76108e37297/004_%E0%B8%81%E0%B8%A7%E0%B8%88_59142_221264_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%80%E0%B8%81%E0%B8%B5%E0%B9%88%E0%B8%A2%E0%B8%A7%E0%B8%81%E0%B8%B1%E0%B8%9A%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%82%E0%B8%AD%E0%B8%84%E0%B8%B7%E0%B8%99%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B8%9B%E0%B8%A3%E0%B8%B1%E0%B8%9A+PDPA.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-ddd62534-4618-4e58-b90f-a76108e37297-p8dhc.6",
  "https://www.gprocurement.go.th/wps/wcm/connect/60eff81d-2992-4911-bba2-cf41444e31e8/01_%E0%B8%81%E0%B8%A7%E0%B8%88_58635_201264_%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%82%E0%B8%AD%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B8%9E%E0%B8%B4%E0%B8%88%E0%B8%B2%E0%B8%A3%E0%B8%93%E0%B8%B2%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B8%84%E0%B8%A7%E0%B8%B2%E0%B8%A1%E0%B9%80%E0%B8%AB%E0%B9%87%E0%B8%99%E0%B8%8A%E0%B8%AD%E0%B8%9A%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B9%80%E0%B8%AA%E0%B8%B5%E0%B8%A2%E0%B8%AB%E0%B8%B2%E0%B8%A2%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-60eff81d-2992-4911-bba2-cf41444e31e8-nU5ghpw",
  "https://www.gprocurement.go.th/wps/wcm/connect/cf1709b4-e70d-42f9-9d5a-82db969ea43a/01_%E0%B8%81%E0%B8%A7%E0%B8%88_58635_201264_%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%82%E0%B8%AD%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B8%9E%E0%B8%B4%E0%B8%88%E0%B8%B2%E0%B8%A3%E0%B8%93%E0%B8%B2%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B8%84%E0%B8%A7%E0%B8%B2%E0%B8%A1%E0%B9%80%E0%B8%AB%E0%B9%87%E0%B8%99%E0%B8%8A%E0%B8%AD%E0%B8%9A%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B9%80%E0%B8%AA%E0%B8%B5%E0%B8%A2%E0%B8%AB%E0%B8%B2%E0%B8%A2%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-cf1709b4-e70d-42f9-9d5a-82db969ea43a-nU5i8jF",
  "https://www.gprocurement.go.th/wps/wcm/connect/58d2783c-c1c1-4cfa-bb81-913004594cf9/06_%E0%B8%81%E0%B8%A7%E0%B8%88_58170_161264_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%A3%E0%B8%93%E0%B8%B5%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B8%8A%E0%B8%99%E0%B8%B0%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%8B%E0%B8%B7%E0%B9%89%E0%B8%AD%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%82%E0%B8%AD%E0%B8%AA%E0%B8%A5%E0%B8%B0%E0%B8%AA%E0%B8%B4%E0%B8%97%E0%B8%98%E0%B8%B4%E0%B9%8C%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-58d2783c-c1c1-4cfa-bb81-913004594cf9-nUa2P2H",
  "https://www.gprocurement.go.th/wps/wcm/connect/4001aaae-48e6-46f1-a7b9-1e6e5a6f5a48/01_%E0%B8%81%E0%B8%A7%E0%B8%88_58075_161264_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9A%E0%B8%AD%E0%B8%81%E0%B9%80%E0%B8%A5%E0%B8%B4%E0%B8%81%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2%E0%B9%81%E0%B8%A5%E0%B8%B0%E0%B8%9E%E0%B8%B4%E0%B8%88%E0%B8%B2%E0%B8%A3%E0%B8%93%E0%B8%B2%E0%B8%A5%E0%B8%87%E0%B9%82%E0%B8%97%E0%B8%A9%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B8%97%E0%B8%B4%E0%B9%89%E0%B8%87%E0%B8%87%E0%B8%B2%E0%B8%99.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-4001aaae-48e6-46f1-a7b9-1e6e5a6f5a48-nTmWBtl",
  "https://www.gprocurement.go.th/wps/wcm/connect/648a7fce-c95b-430d-84f5-d47a1135637f/01_%E0%B8%81%E0%B8%A7%E0%B8%88_57673_151264_+%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B9%80%E0%B8%81%E0%B8%B5%E0%B9%88%E0%B8%A2%E0%B8%A7%E0%B8%81%E0%B8%B1%E0%B8%9A%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2%E0%B8%95%E0%B8%B1%E0%B9%89%E0%B8%87%E0%B8%95%E0%B8%B1%E0%B8%A7%E0%B9%81%E0%B8%97%E0%B8%99.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-648a7fce-c95b-430d-84f5-d47a1135637f-nTm.sqA",
  "https://www.gprocurement.go.th/wps/wcm/connect/4da540b1-20db-496f-9511-cad75787e8a4/02_%E0%B8%81%E0%B8%A7%E0%B8%88_57273_131264_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%AB%E0%B8%99%E0%B8%B1%E0%B8%87%E0%B8%AA%E0%B8%B7%E0%B8%AD%E0%B8%84%E0%B8%93%E0%B8%B0%E0%B8%81%E0%B8%A3%E0%B8%A3%E0%B8%A1%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%A7%E0%B8%B4%E0%B8%99%E0%B8%B4%E0%B8%88%E0%B8%89%E0%B8%B1%E0%B8%A2%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-4da540b1-20db-496f-9511-cad75787e8a4-nTH7CPQ",
  "https://www.gprocurement.go.th/wps/wcm/connect/d80addd7-62a8-4edc-a2df-18be6853f85b/03_%E0%B8%81%E0%B8%A7%E0%B8%88_57271_131264_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B9%83%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%96%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-d80addd7-62a8-4edc-a2df-18be6853f85b-nU5bXQ1",
  "https://www.gprocurement.go.th/wps/wcm/connect/571bd7db-9578-4a02-9bc1-27071fddf524/01_%E0%B8%81%E0%B8%A7%E0%B8%88_57077_131264_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%AB%E0%B8%99%E0%B8%B1%E0%B8%87%E0%B8%AA%E0%B8%B7%E0%B8%AD%E0%B8%84%E0%B8%93%E0%B8%B0%E0%B8%81%E0%B8%A3%E0%B8%A3%E0%B8%A1%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%A7%E0%B8%B4%E0%B8%99%E0%B8%B4%E0%B8%88%E0%B8%89%E0%B8%B1%E0%B8%A2%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-571bd7db-9578-4a02-9bc1-27071fddf524-nTmI-jt",
  "https://www.gprocurement.go.th/wps/wcm/connect/fdfa152b-5932-4fac-ab43-b949c91658fb/01_%E0%B8%81%E0%B8%A7%E0%B8%88_56825_081264_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%80%E0%B8%81%E0%B8%B5%E0%B9%88%E0%B8%A2%E0%B8%A7%E0%B8%81%E0%B8%B1%E0%B8%9A%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%82%E0%B8%AD%E0%B8%84%E0%B8%B7%E0%B8%99%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B8%9B%E0%B8%A3%E0%B8%B1%E0%B8%9A.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-fdfa152b-5932-4fac-ab43-b949c91658fb-nSYnNgG",
  "https://www.gprocurement.go.th/wps/wcm/connect/b351a73e-493f-4142-9aca-c653a58c22de/02_%E0%B8%81%E0%B8%A7%E0%B8%88_56617_081264_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%80%E0%B8%81%E0%B8%B5%E0%B9%88%E0%B8%A2%E0%B8%A7%E0%B8%81%E0%B8%B1%E0%B8%9A%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%80%E0%B8%8A%E0%B9%88%E0%B8%B2%E0%B8%9A%E0%B8%A3%E0%B8%B4%E0%B8%81%E0%B8%A3%E0%B8%A3%E0%B8%B0%E0%B8%9A%E0%B8%9A%E0%B8%81%E0%B8%A5%E0%B9%89%E0%B8%AD%E0%B8%87%E0%B8%A7%E0%B8%87%E0%B8%88%E0%B8%A3%E0%B8%9B%E0%B8%B4%E0%B8%94%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-b351a73e-493f-4142-9aca-c653a58c22de-nSYNHQN",
  "https://www.gprocurement.go.th/wps/wcm/connect/69cfa076-b8ae-4f65-8879-e19260eee903/03_%E0%B8%81%E0%B8%A7%E0%B8%88_56485_071264_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%A1%E0%B8%B2%E0%B8%95%E0%B8%A3%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B8%84%E0%B8%A7%E0%B8%B2%E0%B8%A1%E0%B8%8A%E0%B9%88%E0%B8%A7%E0%B8%A2%E0%B9%80%E0%B8%AB%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B8%9B%E0%B8%A3%E0%B8%B0%E0%B8%81%E0%B8%AD%E0%B8%9A%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-69cfa076-b8ae-4f65-8879-e19260eee903-nSOL4sT",
  "https://www.gprocurement.go.th/wps/wcm/connect/805cb7fc-2820-4cfa-84a2-2030f8f9fdf4/01_%E0%B8%81%E0%B8%A7%E0%B8%88_56481_071264_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%84%E0%B8%B7%E0%B8%99%E0%B9%80%E0%B8%87%E0%B8%B4%E0%B8%99%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B8%9B%E0%B8%A3%E0%B8%B1%E0%B8%9A%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-805cb7fc-2820-4cfa-84a2-2030f8f9fdf4-nSt9LxN",
  "https://www.gprocurement.go.th/wps/wcm/connect/b40604a9-b0aa-4e98-8e3c-f72406f4349a/06_%E0%B8%81%E0%B8%A7%E0%B8%88_56476_071264_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%93%E0%B8%B5%E0%B9%84%E0%B8%94%E0%B9%89%E0%B8%A3%E0%B8%B1%E0%B8%9A%E0%B8%9C%E0%B8%A5%E0%B8%81%E0%B8%A3%E0%B8%B0%E0%B8%97%E0%B8%9A%E0%B8%88%E0%B8%B2%E0%B8%81%E0%B8%81%E0%B8%A3%E0%B8%93%E0%B8%B5%E0%B9%82%E0%B8%A3%E0%B8%84%E0%B8%95%E0%B8%B4%E0%B8%94%E0%B9%80%E0%B8%8A%E0%B8%B7%E0%B9%89%E0%B8%AD%E0%B9%84%E0%B8%A7%E0%B8%A3%E0%B8%B1%E0%B8%AA%E0%B9%82%E0%B8%84%E0%B9%82%E0%B8%A3%E0%B8%99%E0%B8%B2%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-b40604a9-b0aa-4e98-8e3c-f72406f4349a-nT.bIzn",
  "https://www.gprocurement.go.th/wps/wcm/connect/bf2c2b3e-b78c-4d2e-85a2-4bde611f7f8c/02_%E0%B8%81%E0%B8%A7%E0%B8%88_56441_071264_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B9%80%E0%B8%81%E0%B8%B5%E0%B9%88%E0%B8%A2%E0%B8%A7%E0%B8%81%E0%B8%B1%E0%B8%9A%E0%B8%A1%E0%B8%B2%E0%B8%95%E0%B8%A3%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B8%84%E0%B8%A7%E0%B8%B2%E0%B8%A1%E0%B8%8A%E0%B9%88%E0%B8%A7%E0%B8%A2%E0%B9%80%E0%B8%AB%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-bf2c2b3e-b78c-4d2e-85a2-4bde611f7f8c-nSNL5oY",
  "https://www.gprocurement.go.th/wps/wcm/connect/6096e78b-c7dd-46e8-91a3-24fcc7083d88/04_%E0%B8%81%E0%B8%A7%E0%B8%88_56439_071264_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B9%81%E0%B8%9A%E0%B8%9A%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B9%88%E0%B8%AD%E0%B8%AA%E0%B8%A3%E0%B9%89%E0%B8%B2%E0%B8%87.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-6096e78b-c7dd-46e8-91a3-24fcc7083d88-nT.0z0z"
]

ctx = ssl.create_default_context()
ctx.check_hostname = False
ctx.verify_mode = ssl.CERT_NONE

print(f"Downloading {len(page_10_links)} files from Page 10...")

for url in page_10_links:
    try:
        path = urllib.parse.urlparse(url).path
        filename_encoded = os.path.basename(path)
        filename = urllib.parse.unquote(filename_encoded)
        filepath = os.path.join(DOWNLOAD_DIR, filename)
        
        if os.path.exists(filepath):
            print(f"Skip {filename}")
            continue
            
        print(f"DL {filename[:50]}...")
        req = urllib.request.Request(url, headers={'User-Agent': 'Mozilla/5.0'})
        with urllib.request.urlopen(req, context=ctx, timeout=30) as r, open(filepath, 'wb') as f:
            f.write(r.read())
    except Exception as e:
        print(f"Failed: {e}")

print("Page 10 done.")
print()
print("Counting total files in download directory...")
files = [f for f in os.listdir(DOWNLOAD_DIR) if f.endswith('.pdf')]
print(f"Total PDF files: {len(files)}")
