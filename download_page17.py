import os
import urllib.request
import urllib.parse
import ssl

DOWNLOAD_DIR = "/Users/mingsaksaengwilaipon/.gemini/antigravity/scratch/gprocurement_downloads"

# Page 17 links
page_17_links = [
    "https://www.gprocurement.go.th/wps/wcm/connect/6485d3fb-e880-45d0-8c58-f744550e61bf/01_%E0%B8%81%E0%B8%A7%E0%B8%88_39765_130964_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%95%E0%B8%A3%E0%B8%A7%E0%B8%88%E0%B8%A3%E0%B8%B1%E0%B8%9A%E0%B8%96%E0%B8%B1%E0%B8%87%E0%B9%80%E0%B8%81%E0%B9%87%E0%B8%9A%E0%B8%99%E0%B9%89%E0%B8%B3%E0%B9%84%E0%B8%9F%E0%B9%80%E0%B8%9A%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B8%81%E0%B8%A5%E0%B8%B2%E0%B8%AA+%E0%B8%82%E0%B8%99%E0%B8%B2%E0%B8%94+%E0%B9%92%2C%E0%B9%90%E0%B9%90%E0%B9%90+%E0%B8%A5%E0%B8%B4%E0%B8%95%E0%B8%A3%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-6485d3fb-e880-45d0-8c58-f744550e61bf-nXCJGT0",
    "https://www.gprocurement.go.th/wps/wcm/connect/d72b4275-004a-400c-9531-3375541e2e29/02_%E0%B8%81%E0%B8%A7%E0%B8%88_39275_080964_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%94%E0%B8%B3%E0%B9%80%E0%B8%99%E0%B8%B4%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%9A%E0%B8%B1%E0%B8%87%E0%B8%84%E0%B8%B1%E0%B8%9A%E0%B8%AD%E0%B8%87%E0%B8%84%E0%B9%8C%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%80%E0%B8%A0%E0%B8%AA%E0%B8%B1%E0%B8%8A%E0%B8%81%E0%B8%A3%E0%B8%A3%E0%B8%A1%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-d72b4275-004a-400c-9531-3375541e2e29-nOo2K5D",
    "https://www.gprocurement.go.th/wps/wcm/connect/3c1c592e-e8a0-4226-844d-a675edd6d058/02_%E0%B8%81%E0%B8%A7%E0%B8%88_38901_060964_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%81%E0%B8%A3%E0%B8%B0%E0%B8%9A%E0%B8%A7%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%8B%E0%B8%B7%E0%B9%89%E0%B8%AD%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B8%A3%E0%B8%93%E0%B8%B5%E0%B8%A5%E0%B8%B9%E0%B8%81%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B9%80%E0%B8%AB%E0%B8%A1%E0%B8%B2%E0%B8%9A%E0%B8%A3%E0%B8%B4%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%95%E0%B9%88%E0%B8%AD%E0%B9%80%E0%B8%99%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%87%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-3c1c592e-e8a0-4226-844d-a675edd6d058-nXCIYY.",
    "https://www.gprocurement.go.th/wps/wcm/connect/4c2ad5c5-3e4c-4cd0-9b12-0cb31f5d05f6/03_%E0%B8%81%E0%B8%A7%E0%B8%88_38712_060964_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%9E%E0%B8%A3%E0%B8%B0%E0%B8%A3%E0%B8%B2%E0%B8%8A%E0%B8%9A%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%8B%E0%B8%B7%E0%B9%89%E0%B8%AD%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-4c2ad5c5-3e4c-4cd0-9b12-0cb31f5d05f6-nXCJfK4",
    "https://www.gprocurement.go.th/wps/wcm/connect/1e45e501-29ce-4429-a4ac-a6edb9b9aff2/04_%E0%B8%81%E0%B8%A7%E0%B8%88_38700_060964_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%95%E0%B8%B5%E0%B8%84%E0%B8%A7%E0%B8%B2%E0%B8%A1%E0%B8%84%E0%B8%B3%E0%B8%A7%E0%B9%88%E0%B8%B2%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B8%A3%E0%B8%B1%E0%B8%9A%E0%B8%9C%E0%B8%B4%E0%B8%94%E0%B8%8A%E0%B8%AD%E0%B8%9A%E0%B8%AB%E0%B8%A5%E0%B8%B1%E0%B8%81%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-1e45e501-29ce-4429-a4ac-a6edb9b9aff2-nOnAntw",
    "https://www.gprocurement.go.th/wps/wcm/connect/330a2924-6799-423c-b3cc-d949689ec28f/02_%E0%B8%81%E0%B8%A7%E0%B8%88_38316_030964_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%8B%E0%B8%B7%E0%B9%89%E0%B8%AD%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%AB%E0%B8%99%E0%B8%B1%E0%B8%87%E0%B8%AA%E0%B8%B7%E0%B8%AD%E0%B8%84%E0%B8%93%E0%B8%B0%E0%B8%81%E0%B8%A3%E0%B8%A3%E0%B8%A1%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%A7%E0%B8%B4%E0%B8%99%E0%B8%B4%E0%B8%88%E0%B8%89%E0%B8%B1%E0%B8%A2%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-330a2924-6799-423c-b3cc-d949689ec28f-nOhAuo.",
    "https://www.gprocurement.go.th/wps/wcm/connect/46319b3b-19ac-42a5-905b-f20f84554dc1/01_%E0%B8%81%E0%B8%A7%E0%B8%88_38253_030964_%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%AD%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B8%9E%E0%B8%B4%E0%B8%88%E0%B8%B2%E0%B8%A3%E0%B8%93%E0%B8%B2%E0%B8%95%E0%B8%B5%E0%B8%84%E0%B8%A7%E0%B8%B2%E0%B8%A1%E0%B9%81%E0%B8%A5%E0%B8%B0%E0%B8%A7%E0%B8%B4%E0%B8%99%E0%B8%B4%E0%B8%88%E0%B8%89%E0%B8%B1%E0%B8%A2%E0%B8%9B%E0%B8%B1%E0%B8%8D%E0%B8%AB%E0%B8%B2%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-46319b3b-19ac-42a5-905b-f20f84554dc1-nOhAmtk",
    "https://www.gprocurement.go.th/wps/wcm/connect/fb5ffdb0-8d88-4124-a16a-7056ac41275e/03_%E0%B8%81%E0%B8%A7%E0%B8%88_38313_030964_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B9%83%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B9%83%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%81%E0%B8%AB%E0%B9%89%E0%B9%84%E0%B8%82%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2%E0%B9%80%E0%B8%9E%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%A3%E0%B8%B1%E0%B8%9A%E0%B8%A1%E0%B8%AD%E0%B8%9A%E0%B8%87%E0%B8%B2%E0%B8%99%E0%B8%9A%E0%B8%B2%E0%B8%87%E0%B8%AA%E0%B9%88%E0%B8%A7%E0%B8%99.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-fb5ffdb0-8d88-4124-a16a-7056ac41275e-nOhH4MK",
    "https://www.gprocurement.go.th/wps/wcm/connect/497fd8f8-cdc9-422c-bc06-f71e31c1b391/10_%E0%B8%81%E0%B8%A7%E0%B8%88_38384_030964_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%A3%E0%B8%93%E0%B8%B5%E0%B8%AA%E0%B8%AB%E0%B8%81%E0%B8%A3%E0%B8%93%E0%B9%8C%E0%B8%81%E0%B8%AD%E0%B8%87%E0%B8%97%E0%B8%B8%E0%B8%99%E0%B8%AA%E0%B8%A7%E0%B8%99%E0%B8%A2%E0%B8%B2%E0%B8%87%E0%B8%9A%E0%B9%88%E0%B8%AD%E0%B9%84%E0%B8%9F%E0%B9%84%E0%B8%AB%E0%B8%A1%E0%B9%89%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-497fd8f8-cdc9-422c-bc06-f71e31c1b391-nT7bqz6",
    "https://www.gprocurement.go.th/wps/wcm/connect/f4707401-39c4-47af-9c25-4711d800f600/09_%E0%B8%81%E0%B8%A7%E0%B8%88_38381_030964_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%80%E0%B8%81%E0%B8%B5%E0%B9%88%E0%B8%A2%E0%B8%A7%E0%B8%81%E0%B8%B1%E0%B8%9A%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%81%E0%B8%81%E0%B9%89%E0%B9%84%E0%B8%AB%E0%B9%84%E0%B8%82%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-f4707401-39c4-47af-9c25-4711d800f600-nT76vih",
    "https://www.gprocurement.go.th/wps/wcm/connect/af4b49ef-aa30-44a8-92aa-e2b2a3223b8b/08_%E0%B8%81%E0%B8%A7%E0%B8%88_38323_030964_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%81%E0%B8%B3%E0%B8%AB%E0%B8%99%E0%B8%94%E0%B8%A7%E0%B8%B1%E0%B8%99%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B9%80%E0%B8%A3%E0%B8%B4%E0%B9%88%E0%B8%A1%E0%B8%A1%E0%B8%B5%E0%B8%9C%E0%B8%A5%E0%B8%9A%E0%B8%B1%E0%B8%87%E0%B8%84%E0%B8%B1%E0%B8%9A%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-af4b49ef-aa30-44a8-92aa-e2b2a3223b8b-nSZmHha",
    "https://www.gprocurement.go.th/wps/wcm/connect/e11340c1-1c9a-488a-85dd-835d4421ad3a/05_%E0%B8%81%E0%B8%A7%E0%B8%88_38304_030964_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%80%E0%B8%81%E0%B8%B5%E0%B9%88%E0%B8%A2%E0%B8%A7%E0%B8%81%E0%B8%B1%E0%B8%9A%E0%B8%AD%E0%B8%B3%E0%B8%99%E0%B8%B2%E0%B8%88%E0%B8%82%E0%B8%AD%E0%B8%87%E0%B8%AB%E0%B8%B1%E0%B8%A7%E0%B8%AB%E0%B8%99%E0%B9%89%E0%B8%B2%E0%B8%AB%E0%B8%99%E0%B9%88%E0%B8%A7%E0%B8%A2%E0%B8%87%E0%B8%B2%E0%B8%99%E0%B8%82%E0%B8%AD%E0%B8%87%E0%B8%A3%E0%B8%B1%E0%B8%90+%E0%B9%81%E0%B8%A5%E0%B8%B0%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%A1%E0%B8%AD%E0%B8%9A%E0%B8%AD%E0%B8%B3%E0%B8%99%E0%B8%B2%E0%B8%88.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-e11340c1-1c9a-488a-85dd-835d4421ad3a-nXCH.Vj",
    "https://www.gprocurement.go.th/wps/wcm/connect/e861be3d-a232-484c-91bf-d925ba47d5b4/06_%E0%B8%81%E0%B8%A7%E0%B8%88_38262_030964_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%94%E0%B8%B3%E0%B9%80%E0%B8%99%E0%B8%B4%E0%B8%99%E0%B9%82%E0%B8%84%E0%B8%A3%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B0%E0%B8%9A%E0%B8%9A%E0%B8%87%E0%B8%AD%E0%B8%B2%E0%B8%99%E0%B8%AB%E0%B8%A5%E0%B8%B1%E0%B8%81+Core+Banking.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-e861be3d-a232-484c-91bf-d925ba47d5b4-nOivm36",
    "https://www.gprocurement.go.th/wps/wcm/connect/2bff7ce8-1124-4f5d-9c29-1803bdf514ee/04_%E0%B8%81%E0%B8%A7%E0%B8%88_38258_030964_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%AD%E0%B8%AD%E0%B8%AD%E0%B8%81%E0%B8%A3%E0%B8%B0%E0%B9%80%E0%B8%9A%E0%B8%B5%E0%B8%A2%E0%B8%9A%E0%B8%84%E0%B8%93%E0%B8%B0%E0%B8%81%E0%B8%A3%E0%B8%A3%E0%B8%A1%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%99%E0%B8%B4%E0%B8%84%E0%B8%A1%E0%B8%AD%E0%B8%B8%E0%B8%95%E0%B8%AA%E0%B8%B2%E0%B8%AB%E0%B8%81%E0%B8%A3%E0%B8%A3%E0%B8%A1%E0%B9%81%E0%B8%AB%E0%B9%88%E0%B8%87%E0%B8%9B%E0%B8%A3%E0%B8%B0%E0%B9%80%E0%B8%97%E0%B8%A8%E0%B9%84%E0%B8%97%E0%B8%A2%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-2bff7ce8-1124-4f5d-9c29-1803bdf514ee-nXCH2rT",
    "https://www.gprocurement.go.th/wps/wcm/connect/54272512-1b6f-493d-8ebc-38c1226d97f5/01_%E0%B8%81%E0%B8%A7%E0%B8%88_37649_310864_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%94%E0%B9%8D%E0%B8%B2%E0%B9%80%E0%B8%99%E0%B8%B4%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%82%E0%B8%84%E0%B8%A3%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-54272512-1b6f-493d-8ebc-38c1226d97f5-nT7gE83",
    "https://www.gprocurement.go.th/wps/wcm/connect/8be68e83-ebc0-4735-bb8d-ba825e2b189c/02_%E0%B8%81%E0%B8%A7%E0%B8%88_37648_310864_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%A3%E0%B8%93%E0%B8%B5%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%84%E0%B8%B7%E0%B8%99%E0%B8%AB%E0%B8%A5%E0%B8%B1%E0%B8%81%E0%B8%9B%E0%B8%A3%E0%B8%B0%E0%B8%81%E0%B8%B1%E0%B8%99%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-8be68e83-ebc0-4735-bb8d-ba825e2b189c-nT7rCVK",
    "https://www.gprocurement.go.th/wps/wcm/connect/0efb1cb6-cc78-4028-96b6-1b0d3947bed4/01_%E0%B8%81%E0%B8%A7%E0%B8%88_37387_300864_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%9E%E0%B8%A3%E0%B8%B0%E0%B8%A3%E0%B8%B2%E0%B8%8A%E0%B8%9A%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-0efb1cb6-cc78-4028-96b6-1b0d3947bed4-nOhrSl3",
    "https://www.gprocurement.go.th/wps/wcm/connect/2e71a160-7f5c-4258-b267-3ab27089e0b0/03_%E0%B8%81%E0%B8%A7%E0%B8%88_37615_300864_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%84%E0%B8%B3%E0%B9%80%E0%B8%99%E0%B8%B4%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%97%E0%B8%B3%E0%B8%9B%E0%B8%A3%E0%B8%B0%E0%B8%81%E0%B8%B1%E0%B8%99%E0%B8%AA%E0%B8%B8%E0%B8%82%E0%B8%A0%E0%B8%B2%E0%B8%9E%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-2e71a160-7f5c-4258-b267-3ab27089e0b0-nOhAbf9",
    "https://www.gprocurement.go.th/wps/wcm/connect/8828bbee-91bd-4f3c-a568-2b4e9925ad9b/02_%E0%B8%81%E0%B8%A7%E0%B8%88_37381_300864_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%A3%E0%B8%93%E0%B8%B5%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%81%E0%B8%81%E0%B9%89%E0%B9%84%E0%B8%82%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B9%88%E0%B8%AD%E0%B8%AA%E0%B8%A3%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-8828bbee-91bd-4f3c-a568-2b4e9925ad9b-nOhz.IK",
    "https://www.gprocurement.go.th/wps/wcm/connect/f8a4da14-1de8-47db-be5b-b6c105bbe5d8/04_%E0%B8%81%E0%B8%A7%E0%B8%88_37448_300864_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-f8a4da14-1de8-47db-be5b-b6c105bbe5d8-nT24ncD"
]

ctx = ssl.create_default_context()
ctx.check_hostname = False
ctx.verify_mode = ssl.CERT_NONE

print(f"Downloading {len(page_17_links)} files from Page 17...")

success = 0
failed = 0
for url in page_17_links:
    try:
        path = urllib.parse.urlparse(url).path
        filename_encoded = os.path.basename(path)
        filename = urllib.parse.unquote(filename_encoded)
        
        # Simple sanitization
        filename = filename.replace('\ufe6f', '').replace('%EF%B9%AF', '')
        
        filepath = os.path.join(DOWNLOAD_DIR, filename)
        
        if os.path.exists(filepath):
            print(f"Skip (exists): {filename[:40]}...")
            success += 1
            continue
            
        print(f"DL: {filename[:40]}...")
        req = urllib.request.Request(url, headers={'User-Agent': 'Mozilla/5.0'})
        with urllib.request.urlopen(req, context=ctx, timeout=30) as r, open(filepath, 'wb') as f:
            f.write(r.read())
        success += 1
    except Exception as e:
        print(f"Failed: {filename[:30]}... - {e}")
        failed += 1

print(f"\nPage 17 done. Success: {success}, Failed: {failed}")
print()
print("Counting total files in download directory...")
files = [f for f in os.listdir(DOWNLOAD_DIR) if f.endswith('.pdf')]
print(f"Total PDF files: {len(files)}")
