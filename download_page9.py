import os
import urllib.request
import urllib.parse
import ssl

DOWNLOAD_DIR = "/Users/mingsaksaengwilaipon/.gemini/antigravity/scratch/gprocurement_downloads"

page_9_links = [
  "https://www.gprocurement.go.th/wps/wcm/connect/bfaba619-445d-4f42-9e27-c39f75cfe2d0/001_%E0%B8%81%E0%B8%A7%E0%B8%88_4497_010265_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%82%E0%B8%AD%E0%B8%81%E0%B8%A5%E0%B8%B1%E0%B8%9A%E0%B8%84%E0%B8%B7%E0%B8%99%E0%B8%AA%E0%B8%96%E0%B8%B2%E0%B8%99%E0%B8%B0%E0%B8%84%E0%B8%B9%E0%B9%88%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2+PDPA.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-bfaba619-445d-4f42-9e27-c39f75cfe2d0-p8dBKMa",
  "https://www.gprocurement.go.th/wps/wcm/connect/f5cb91ef-8283-43bf-bc3b-30d70a6452de/001_%E0%B8%81%E0%B8%A7%E0%B8%88_3619_260165_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%AF+PDPA.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-f5cb91ef-8283-43bf-bc3b-30d70a6452de-p8dAl88",
  "https://www.gprocurement.go.th/wps/wcm/connect/e3d555eb-8a69-4ab7-b4dc-73fb7e2bb0f0/001_%E0%B8%81%E0%B8%A7%E0%B8%88_3461_250165_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%81%E0%B8%95%E0%B9%88%E0%B8%87%E0%B8%95%E0%B8%B1%E0%B9%89%E0%B8%87%E0%B8%9E%E0%B8%99%E0%B8%B1%E0%B8%81%E0%B8%87%E0%B8%B2%E0%B8%99%E0%B9%81%E0%B8%A5%E0%B8%B0%E0%B8%A5%E0%B8%B9%E0%B8%81%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B8%AD%E0%B8%87%E0%B8%97%E0%B8%B8%E0%B8%99%E0%B9%80%E0%B8%9B%E0%B9%87%E0%B8%99%E0%B8%84%E0%B8%93%E0%B8%B0%E0%B8%81%E0%B8%A3%E0%B8%A3%E0%B8%A1%E0%B8%81%E0%B8%B2%E0%B8%AF+PDPA+.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-e3d555eb-8a69-4ab7-b4dc-73fb7e2bb0f0-p8ejItV",
  "https://www.gprocurement.go.th/wps/wcm/connect/a998f041-a48d-4795-bb06-dd29e17a72d0/001_%E0%B8%81%E0%B8%A7%E0%B8%88_3351_240165_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%82%E0%B8%AD%E0%B8%84%E0%B8%B7%E0%B8%99%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B8%9B%E0%B8%A3%E0%B8%B1%E0%B8%9A%E0%B8%AF+PDPA.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-a998f041-a48d-4795-bb06-dd29e17a72d0-p8dBHJQ",
  "https://www.gprocurement.go.th/wps/wcm/connect/c4e74dac-b012-4741-a03a-aba3ae0cd396/003_%E0%B8%81%E0%B8%A7%E0%B8%88_2619_200165_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%8B%E0%B8%B7%E0%B9%89%E0%B8%AD%E0%B8%A3%E0%B8%96%E0%B8%A2%E0%B8%99%E0%B8%95%E0%B9%8C%E0%B8%AF+PDPA.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-c4e74dac-b012-4741-a03a-aba3ae0cd396-p8dvI7A",
  "https://www.gprocurement.go.th/wps/wcm/connect/611849fd-adf7-4895-ab80-c8fbc76a5b4e/002_%E0%B8%81%E0%B8%A7%E0%B8%88_2615_200165_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%94%E0%B8%B3%E0%B9%80%E0%B8%99%E0%B8%B4%E0%B8%99%E0%B9%82%E0%B8%84%E0%B8%A3%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%83%E0%B8%AB%E0%B8%A1%E0%B9%88%E0%B8%AF+PDPA.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-611849fd-adf7-4895-ab80-c8fbc76a5b4e-p8dvf8F",
  "https://www.gprocurement.go.th/wps/wcm/connect/f2dc0f87-5626-4a27-93e9-ae4d27f98860/001_%E0%B8%81%E0%B8%A7%E0%B8%88_2608_200165_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%94%E0%B8%B3%E0%B9%80%E0%B8%99%E0%B8%B4%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%AF+PDPA.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-f2dc0f87-5626-4a27-93e9-ae4d27f98860-p8duCC4",
  "https://www.gprocurement.go.th/wps/wcm/connect/657d7875-30a3-45f7-ae88-b8869cf34e0b/001_%E0%B8%81%E0%B8%A7%E0%B8%88_2132_180165_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%94%E0%B8%B3%E0%B9%80%E0%B8%99%E0%B8%B4%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%A0%E0%B8%B2%E0%B8%A2%E0%B8%AB%E0%B8%A5%E0%B8%B1%E0%B8%87%E0%B8%9A%E0%B8%AD%E0%B8%81%E0%B9%80%E0%B8%A5%E0%B8%B4%E0%B8%81%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%AF+PDPA.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-657d7875-30a3-45f7-ae88-b8869cf34e0b-p8eillK",
  "https://www.gprocurement.go.th/wps/wcm/connect/86444b57-21c1-45c5-a9b2-472b67de1d60/001_%E0%B8%81%E0%B8%A7%E0%B8%88_1500_140165_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%82%E0%B8%AD%E0%B8%81%E0%B8%A5%E0%B8%B1%E0%B8%9A%E0%B8%84%E0%B8%B7%E0%B8%99%E0%B8%AA%E0%B8%96%E0%B8%B2%E0%B8%99%E0%B8%B0%E0%B8%84%E0%B8%B9%E0%B9%88%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2+PDPA.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-86444b57-21c1-45c5-a9b2-472b67de1d60-p8drW.e",
  "https://www.gprocurement.go.th/wps/wcm/connect/a9e4d4b5-5f46-4bf7-8dc0-dbd2a9698e9a/002_%E0%B8%81%E0%B8%A7%E0%B8%88_1498_140165_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9E%E0%B8%B4%E0%B8%88%E0%B8%B2%E0%B8%A3%E0%B8%93%E0%B8%B2%E0%B8%84%E0%B8%B8%E0%B8%93%E0%B8%AA%E0%B8%A1%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B9%83%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%A2%E0%B8%B7%E0%B9%88%E0%B8%99%E0%B8%9C%E0%B8%A5%E0%B8%87%E0%B8%B2%E0%B8%99%E0%B8%AF+PDPA+.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-a9e4d4b5-5f46-4bf7-8dc0-dbd2a9698e9a-p8ehBwq",
  "https://www.gprocurement.go.th/wps/wcm/connect/ff7a9cbc-62bc-4a54-8b00-3e94a231b83b/001_%E0%B8%81%E0%B8%A7%E0%B8%88_1460_130165_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%82%E0%B8%AD%E0%B8%84%E0%B8%B7%E0%B8%99%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B8%9B%E0%B8%A3%E0%B8%B1%E0%B8%9A%E0%B8%AF+PDPA.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-ff7a9cbc-62bc-4a54-8b00-3e94a231b83b-p8dsAGb",
  "https://www.gprocurement.go.th/wps/wcm/connect/26c020c5-dde5-4a84-afc1-d9609a454eb0/002_%E0%B8%81%E0%B8%A7%E0%B8%88_1260_120165_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%80%E0%B8%81%E0%B8%B5%E0%B9%88%E0%B8%A2%E0%B8%A7%E0%B8%81%E0%B8%B1%E0%B8%9A%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%AD%E0%B8%B1%E0%B8%95%E0%B8%A3%E0%B8%B2%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B8%9B%E0%B8%A3%E0%B8%B1%E0%B8%9A%E0%B8%AF+PDPA.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-26c020c5-dde5-4a84-afc1-d9609a454eb0-p8egdsa",
  "https://www.gprocurement.go.th/wps/wcm/connect/ecbe84fc-c55a-4bcc-8aed-3e1e902ac864/001_%E0%B8%81%E0%B8%A7%E0%B8%88_1258_120165_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%87%E0%B8%B2%E0%B8%99%E0%B9%82%E0%B8%84%E0%B8%A3%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%AF+PDPA.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-ecbe84fc-c55a-4bcc-8aed-3e1e902ac864-p8dg.xV",
  "https://www.gprocurement.go.th/wps/wcm/connect/7110b603-3bec-4694-a4ef-f752df7e5dee/001_%E0%B8%81%E0%B8%A7%E0%B8%88_761_100165_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%82%E0%B8%AD%E0%B8%84%E0%B8%B7%E0%B8%99%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B8%9B%E0%B8%A3%E0%B8%B1%E0%B8%9A%E0%B8%AF+PDPA.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-7110b603-3bec-4694-a4ef-f752df7e5dee-p8dgKEz",
  "https://www.gprocurement.go.th/wps/wcm/connect/39d75eca-e8dd-451c-a7a5-1fb84cbe7e33/001_%E0%B8%81%E0%B8%A7%E0%B8%88_000069_040165_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%A1%E0%B8%B2%E0%B8%95%E0%B8%A3%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%8A%E0%B9%88%E0%B8%A7%E0%B8%A2%E0%B9%80%E0%B8%AB%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B8%9B%E0%B8%A3%E0%B8%B0%E0%B8%81%E0%B8%AD%E0%B8%9A%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%AF+PDPA.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-39d75eca-e8dd-451c-a7a5-1fb84cbe7e33-p8efmo2",
  "https://www.gprocurement.go.th/wps/wcm/connect/45c49b30-9a7a-422c-8774-1df0987d544c/004_%E0%B8%81%E0%B8%A7%E0%B8%88_60430_301264_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%A3%E0%B8%93%E0%B8%B5%E0%B9%82%E0%B8%A3%E0%B8%87%E0%B8%9E%E0%B8%A2%E0%B8%B2%E0%B8%9A%E0%B8%B2%E0%B8%A5%E0%B8%94%E0%B8%B3%E0%B9%80%E0%B8%99%E0%B8%B4%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B9%80%E0%B8%AB%E0%B8%A1%E0%B8%B2%E0%B8%9A%E0%B8%A3%E0%B8%B4%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%AF+PDPA.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-45c49b30-9a7a-422c-8774-1df0987d544c-p8e95St",
  "https://www.gprocurement.go.th/wps/wcm/connect/dd4c9d8f-851f-4480-b83f-4f33d9db5eef/002_%E0%B8%81%E0%B8%A7%E0%B8%88_60429_301264_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%AB%E0%B8%99%E0%B8%B1%E0%B8%87%E0%B8%AA%E0%B8%B7%E0%B8%AD%E0%B8%A3%E0%B8%B1%E0%B8%9A%E0%B8%A3%E0%B8%AD%E0%B8%87%E0%B8%88%E0%B8%B2%E0%B8%81%E0%B8%A8%E0%B8%B9%E0%B8%99%E0%B8%A2%E0%B9%8C%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%A1%E0%B8%B9%E0%B8%A5%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B8%9B%E0%B8%A3%E0%B8%B6%E0%B8%81%E0%B8%A9%E0%B8%B2+PDPA.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-dd4c9d8f-851f-4480-b83f-4f33d9db5eef-p8djxHj",
  "https://www.gprocurement.go.th/wps/wcm/connect/836334fe-f6f3-40db-bd9c-fcf48ac03f7b/001_%E0%B8%81%E0%B8%A7%E0%B8%88_60428_301264_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%9E%E0%B8%A3%E0%B8%B0%E0%B8%A3%E0%B8%B2%E0%B8%8A%E0%B8%9A%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%AF+PDPA.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-836334fe-f6f3-40db-bd9c-fcf48ac03f7b-p8dh6kp",
  "https://www.gprocurement.go.th/wps/wcm/connect/4e308c76-8b09-41aa-89cb-fc2c68fe834c/003_%E0%B8%81%E0%B8%A7%E0%B8%88_60427_301264_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%A1%E0%B8%B2%E0%B8%95%E0%B8%A3%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B8%84%E0%B8%A7%E0%B8%B2%E0%B8%A3%E0%B8%8A%E0%B9%88%E0%B8%A7%E0%B8%A2%E0%B9%80%E0%B8%AB%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B8%9B%E0%B8%A3%E0%B8%B0%E0%B8%81%E0%B8%AD%E0%B8%9A%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%AF+PDPA.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-4e308c76-8b09-41aa-89cb-fc2c68fe834c-p8e8k6c",
  "https://www.gprocurement.go.th/wps/wcm/connect/f15ab375-08ca-42f0-bae4-09ac6957fe67/001_%E0%B8%81%E0%B8%A7%E0%B8%88_59767_271264_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%81%E0%B8%8E%E0%B8%81%E0%B8%A3%E0%B8%B0%E0%B8%97%E0%B8%A3%E0%B8%A7%E0%B8%87%E0%B8%AF+PDPA.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-f15ab375-08ca-42f0-bae4-09ac6957fe67-p8ey7Kg"
]

ctx = ssl.create_default_context()
ctx.check_hostname = False
ctx.verify_mode = ssl.CERT_NONE

print(f"Downloading {len(page_9_links)} files from Page 9...")

for url in page_9_links:
    try:
        path = urllib.parse.urlparse(url).path
        filename_encoded = os.path.basename(path)
        filename = urllib.parse.unquote(filename_encoded)
        filepath = os.path.join(DOWNLOAD_DIR, filename)
        
        if os.path.exists(filepath):
            print(f"Skip {filename}")
            continue
            
        print(f"DL {filename[:50]}...")
        req = urllib.request.Request(url, headers={'User-Agent': 'Mozilla/5.0'})
        with urllib.request.urlopen(req, context=ctx, timeout=30) as r, open(filepath, 'wb') as f:
            f.write(r.read())
    except Exception as e:
        print(f"Failed: {e}")

print("Page 9 done.")
print()
print("Counting total files in download directory...")
files = [f for f in os.listdir(DOWNLOAD_DIR) if f.endswith('.pdf')]
print(f"Total PDF files: {len(files)}")
