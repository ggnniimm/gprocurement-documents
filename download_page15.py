import os
import urllib.request
import urllib.parse
import ssl

DOWNLOAD_DIR = "/Users/mingsaksaengwilaipon/.gemini/antigravity/scratch/gprocurement_downloads"

# Page 15 links
page_15_links = [
    "https://www.gprocurement.go.th/wps/wcm/connect/0c3dc1d0-8077-4259-9c7a-a8f236de60af/12_%E0%B8%81%E0%B8%A7%E0%B8%88_46272_121064_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%A3%E0%B8%B0%E0%B8%81%E0%B8%B2%E0%B8%A1%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B8%8A%E0%B8%99%E0%B8%B0%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B9%88%E0%B8%AD%E0%B8%AA%E0%B8%A3%E0%B9%89%E0%B8%B2%E0%B8%87.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-0c3dc1d0-8077-4259-9c7a-a8f236de60af-nQ3Dpsk",
    "https://www.gprocurement.go.th/wps/wcm/connect/52928e45-2b6e-41c8-85eb-aa80520fb43c/01_%E0%B8%81%E0%B8%A7%E0%B8%88_46243_121064_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%AB%E0%B8%99%E0%B8%B1%E0%B8%87%E0%B8%AA%E0%B8%B7%E0%B8%AD%E0%B8%84%E0%B8%93%E0%B8%B2%E0%B8%81%E0%B8%A3%E0%B8%A3%E0%B8%A1%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%A3%E0%B8%A7%E0%B8%B4%E0%B8%99%E0%B8%B4%E0%B8%88%E0%B8%89%E0%B8%B1%E0%B8%A2%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-52928e45-2b6e-41c8-85eb-aa80520fb43c-nPqzF-G",
    "https://www.gprocurement.go.th/wps/wcm/connect/06a5499e-e79e-48b9-a00c-7c3f4fd6fc6b/11_%E0%B8%81%E0%B8%A7%E0%B8%88_46228_121064_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%82%E0%B8%A2%E0%B8%B2%E0%B8%A2%E0%B8%A3%E0%B8%B0%E0%B8%A2%E0%B8%B0%E0%B9%80%E0%B8%A7%E0%B8%A5%E0%B8%B2%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-06a5499e-e79e-48b9-a00c-7c3f4fd6fc6b-nQ3zg.J",
    "https://www.gprocurement.go.th/wps/wcm/connect/b563a5cf-0fef-47cb-b1bd-3098d2a150d0/06_%E0%B8%81%E0%B8%A7%E0%B8%88_46211_121064_+%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%8B%E0%B8%B7%E0%B9%89%E0%B8%AD%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B9%81%E0%B8%A5%E0%B8%B0%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9A%E0%B8%A3%E0%B8%B4%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%9E%E0%B8%B1%E0%B8%AA%E0%B8%94%E0%B8%B8.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-b563a5cf-0fef-47cb-b1bd-3098d2a150d0-nPKOhPn",
    "https://www.gprocurement.go.th/wps/wcm/connect/52c394d0-483b-4887-8da2-81aed80b6a11/03_%E0%B8%81%E0%B8%A7%E0%B8%88_46200_121064_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9A%E0%B8%AD%E0%B8%81%E0%B9%80%E0%B8%A5%E0%B8%B4%E0%B8%81%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-52c394d0-483b-4887-8da2-81aed80b6a11-nPA9dKA",
    "https://www.gprocurement.go.th/wps/wcm/connect/704f0fb3-54b6-40ef-b34f-cb123745605d/10_%E0%B8%81%E0%B8%A7%E0%B8%88_46177_121064_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%AD%E0%B8%B8%E0%B8%97%E0%B8%98%E0%B8%A3%E0%B8%93%E0%B9%8C%E0%B8%84%E0%B8%B1%E0%B8%94%E0%B8%84%E0%B9%89%E0%B8%B2%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%A3%E0%B8%B0%E0%B8%81%E0%B8%B2%E0%B8%A8%E0%B9%83%E0%B8%8A%E0%B9%89%E0%B8%81%E0%B8%8E%E0%B8%81%E0%B8%A3%E0%B8%B0%E0%B8%97%E0%B8%A3%E0%B8%A7%E0%B8%87%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-704f0fb3-54b6-40ef-b34f-cb123745605d-nQ3uY9O",
    "https://www.gprocurement.go.th/wps/wcm/connect/79eff48c-a718-44fd-9d6e-ac461f907406/09_%E0%B8%81%E0%B8%A7%E0%B8%88_46174_121064_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%9E%E0%B8%A3%E0%B8%B0%E0%B8%A3%E0%B8%B2%E0%B8%8A%E0%B8%9A%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-79eff48c-a718-44fd-9d6e-ac461f907406-nQ30ylj",
    "https://www.gprocurement.go.th/wps/wcm/connect/70d52f8c-7ff9-49d0-8a3e-625ab2799c4d/08_%E0%B8%81%E0%B8%A7%E0%B8%88_46170_121064_+%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%83%E0%B8%8A%E0%B9%89%E0%B8%87%E0%B8%B2%E0%B8%99%E0%B8%A3%E0%B8%B0%E0%B8%9A%E0%B8%9A%E0%B8%AA%E0%B8%B2%E0%B8%A3%E0%B8%9A%E0%B8%A3%E0%B8%A3%E0%B8%93%E0%B8%AD%E0%B8%B4%E0%B9%80%E0%B8%A5%E0%B9%87%E0%B8%81%E0%B8%97%E0%B8%A3%E0%B8%AD%E0%B8%99%E0%B8%B4%E0%B8%81%E0%B8%AA%E0%B9%8C%E0%B9%83%E0%B8%99%E0%B8%87%E0%B8%B2%E0%B8%99%E0%B8%9A%E0%B8%A3%E0%B8%B4%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%84%E0%B8%A5%E0%B8%B1%E0%B8%87.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-70d52f8c-7ff9-49d0-8a3e-625ab2799c4d-nQ2Z8zj",
    "https://www.gprocurement.go.th/wps/wcm/connect/d3ba0223-0c06-401f-b3bf-722bbcc7e7b3/07_%E0%B8%81%E0%B8%A7%E0%B8%88_46162_121064_+%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%99%E0%B9%8D%E0%B8%B2%E0%B8%AB%E0%B8%A5%E0%B8%B1%E0%B8%81%E0%B8%9B%E0%B8%A3%E0%B8%B0%E0%B8%81%E0%B8%B1%E0%B8%99%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2%E0%B9%84%E0%B8%9B%E0%B8%A7%E0%B8%B2%E0%B8%87%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-d3ba0223-0c06-401f-b3bf-722bbcc7e7b3-nPL2Pjp",
    "https://www.gprocurement.go.th/wps/wcm/connect/400d4216-9acf-4252-8b32-6d778e4ca951/02_%E0%B8%81%E0%B8%A7%E0%B8%88_46063_111064_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B3%E0%B8%AB%E0%B8%99%E0%B9%88%E0%B8%B2%E0%B8%A2%E0%B8%9E%E0%B8%B1%E0%B8%AA%E0%B8%94%E0%B8%B8%E0%B8%94%E0%B9%89%E0%B8%A7%E0%B8%A2%E0%B8%A7%E0%B8%B4%E0%B8%98%E0%B8%B5%E0%B9%81%E0%B8%A5%E0%B8%81%E0%B9%80%E0%B8%9B%E0%B8%A5%E0%B8%B5%E0%B9%88%E0%B8%A2%E0%B8%99.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-400d4216-9acf-4252-8b32-6d778e4ca951-nPKaaT2",
    "https://www.gprocurement.go.th/wps/wcm/connect/2a5a70d5-f5a3-4042-a12e-2ce75e406d24/05_%E0%B8%81%E0%B8%A7%E0%B8%88_46044_111064_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%80%E0%B8%9A%E0%B8%B4%E0%B8%81%E0%B8%88%E0%B9%88%E0%B8%B2%E0%B8%A2%E0%B9%80%E0%B8%87%E0%B8%B4%E0%B8%99%E0%B8%AA%E0%B9%88%E0%B8%A7%E0%B8%99%E0%B9%80%E0%B8%81%E0%B8%B4%E0%B8%99%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B9%80%E0%B8%8A%E0%B9%88%E0%B8%B2%E0%B9%80%E0%B8%84%E0%B8%A3%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%97%E0%B8%B6%E0%B9%88%E0%B8%AD%E0%B8%87%E0%B8%96%E0%B9%88%E0%B8%B2%E0%B8%A2%E0%B9%80%E0%B8%AD%E0%B8%81%E0%B8%AA%E0%B8%B2%E0%B8%A3.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-2a5a70d5-f5a3-4042-a12e-2ce75e406d24-nPL00d-",
    "https://www.gprocurement.go.th/wps/wcm/connect/182964f3-b21e-4f7d-91f8-e9ad4aea5b15/01_%E0%B8%81%E0%B8%A7%E0%B8%88_46043_111064_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%A3%E0%B8%93%E0%B8%B5%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9A%E0%B8%AD%E0%B8%81%E0%B9%80%E0%B8%A5%E0%B8%B4%E0%B8%81%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2+%E0%B9%81%E0%B8%A5%E0%B8%B0%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9E%E0%B8%B4%E0%B8%88%E0%B8%B2%E0%B8%A3%E0%B8%93%E0%B8%B2%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B8%9B%E0%B8%A3%E0%B8%B1%E0%B8%9A%E0%BAF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-182964f3-b21e-4f7d-91f8-e9ad4aea5b15-nPK1tVE",
    "https://www.gprocurement.go.th/wps/wcm/connect/5f43d5fc-4d76-463d-abe9-182ec4c306a8/04_%E0%B8%81%E0%B8%A7%E0%B8%88_46042_111064_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%9E%E0%B8%A3%E0%B8%B0%E0%B8%A3%E0%B8%B2%E0%B8%8A%E0%B8%9A%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-5f43d5fc-4d76-463d-abe9-182ec4c306a8-nPKeR4c",
    "https://www.gprocurement.go.th/wps/wcm/connect/e2b661a2-7129-4618-9211-2e39c71a7998/06_%E0%B8%81%E0%B8%A7%E0%B8%88_46039_111064_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B9%83%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B8%94%E0%B8%B4%E0%B8%99%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-e2b661a2-7129-4618-9211-2e39c71a7998-nPL1rxL",
    "https://www.gprocurement.go.th/wps/wcm/connect/0d61b4d3-ee10-48df-9638-92b3333a3134/03_%E0%B8%81%E0%B8%A7%E0%B8%88_46035_111064_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B3%E0%B8%A3%E0%B8%93%E0%B8%B5%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B9%80%E0%B8%AD%E0%B8%81%E0%B8%8A%E0%B8%99%E0%B9%80%E0%B8%9B%E0%B9%87%E0%B8%99%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B8%84%E0%B8%A7%E0%B8%9A%E0%B8%84%E0%B8%B8%E0%B8%A1%E0%B8%87%E0%B8%B2%E0%B8%99%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-0d61b4d3-ee10-48df-9638-92b3333a3134-nPKcSjR",
    "https://www.gprocurement.go.th/wps/wcm/connect/8ae9e4fd-230a-44c6-8bf3-048f28b4f12e/07_%E0%B8%81%E0%B8%A7%E0%B8%88_46026_111064_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%A3%E0%B8%B0%E0%B9%80%E0%B8%9A%E0%B8%B5%E0%B8%A2%E0%B8%9A%E0%B8%81%E0%B8%A3%E0%B8%B0%E0%B8%97%E0%B8%A3%E0%B8%A7%E0%B8%87%E0%B8%10%E0%B8%B2%E0%B8%A3%E0%B8%84%E0%B8%A5%E0%B8%B1%E0%B8%87%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-8ae9e4fd-230a-44c6-8bf3-048f28b4f12e-nQ2Webp",
    "https://www.gprocurement.go.th/wps/wcm/connect/0cc070de-4bf8-442d-85fd-04b143d77d59/02_%E0%B8%81%E0%B8%A7%E0%B8%88_44073_300964_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9E%E0%B8%B4%E0%B8%88%E0%B8%B2%E0%B8%A3%E0%B8%93%E0%B8%B2%E0%B8%9C%E0%B8%A5%E0%B8%87%E0%B8%B2%E0%B8%99%E0%B8%81%E0%B9%88%E0%B8%AD%E0%B8%AA%E0%B8%A3%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%9B%E0%B8%A3%E0%B8%B0%E0%B9%80%E0%B8%A0%E0%B8%97%E0%B9%80%E0%B8%94%E0%B8%B5%E0%B8%A2%E0%B8%A7%E0%B8%81%E0%B8%B1%E0%B8%99.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-0cc070de-4bf8-442d-85fd-04b143d77d59-nOhudBr",
    "https://www.gprocurement.go.th/wps/wcm/connect/0962ddee-27e1-4c7d-9788-58e356d2430c/02_%E0%B8%81%E0%B8%A7%E0%B8%88_43981_300964_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B9%83%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%84%E0%B8%B7%E0%B8%99%E0%B8%AB%E0%B8%A5%E0%B8%B1%E0%B8%81%E0%B8%9B%E0%B8%A3%E0%B8%B0%E0%B8%81%E0%B8%B1%E0%B8%99%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-0962ddee-27e1-4c7d-9788-58e356d2430c-nXyxGO8",
    "https://www.gprocurement.go.th/wps/wcm/connect/fe2294f6-66be-4741-8a42-f8377743ed7d/01_%E0%B8%81%E0%B8%A7%E0%B8%88_43693_290964_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9E%E0%B8%B4%E0%B8%88%E0%B8%B2%E0%B8%A3%E0%B8%93%E0%B8%B2%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B8%A2%E0%B8%B7%E0%B9%88%E0%B8%99%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B9%80%E0%B8%AA%E0%B8%99%E0%B8%AD%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-fe2294f6-66be-4741-8a42-f8377743ed7d-nOnGU9v",
    "https://www.gprocurement.go.th/wps/wcm/connect/b426fce8-418a-4cfe-bccb-fff4754f2af2/03_%E0%B8%81%E0%B8%A7%E0%B8%88_43419_280964_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%95%E0%B8%A3%E0%B8%A7%E0%B8%8B%E0%B9%88%E0%B8%AD%E0%B8%A1%E0%B9%82%E0%B8%84%E0%B8%A3%E0%B8%87%E0%B8%AA%E0%B8%A3%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%AD%E0%B8%B2%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%A2%E0%B8%B2%E0%B8%99%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-b426fce8-418a-4cfe-bccb-fff4754f2af2-nOhv3Mu"
]

ctx = ssl.create_default_context()
ctx.check_hostname = False
ctx.verify_mode = ssl.CERT_NONE

print(f"Downloading {len(page_15_links)} files from Page 15...")

success = 0
failed = 0
for url in page_15_links:
    try:
        path = urllib.parse.urlparse(url).path
        filename_encoded = os.path.basename(path)
        filename = urllib.parse.unquote(filename_encoded)
        filepath = os.path.join(DOWNLOAD_DIR, filename)
        
        if os.path.exists(filepath):
            print(f"Skip (exists): {filename[:40]}...")
            success += 1
            continue
            
        print(f"DL: {filename[:40]}...")
        req = urllib.request.Request(url, headers={'User-Agent': 'Mozilla/5.0'})
        with urllib.request.urlopen(req, context=ctx, timeout=30) as r, open(filepath, 'wb') as f:
            f.write(r.read())
        success += 1
    except Exception as e:
        print(f"Failed: {filename[:30]}... - {e}")
        failed += 1

print(f"\nPage 15 done. Success: {success}, Failed: {failed}")
print()
print("Counting total files in download directory...")
files = [f for f in os.listdir(DOWNLOAD_DIR) if f.endswith('.pdf')]
print(f"Total PDF files: {len(files)}")
