import os
import urllib.request
import urllib.parse
import ssl

DOWNLOAD_DIR = "/Users/mingsaksaengwilaipon/.gemini/antigravity/scratch/gprocurement_downloads"

# Page 11 - fresh links from new extraction
page_11_links = [
    "https://www.gprocurement.go.th/wps/wcm/connect/af73646e-4190-4ab5-881b-27b2a7da98e5/01_%E0%B8%81%E0%B8%A7%E0%B8%88_55464_301164_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%84%E0%B8%B7%E0%B8%99%E0%B9%80%E0%B8%87%E0%B8%B4%E0%B8%99%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B8%9B%E0%B8%A3%E0%B8%B1%E0%B8%9A.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-af73646e-4190-4ab5-881b-27b2a7da98e5-nSOW9Hv",
    "https://www.gprocurement.go.th/wps/wcm/connect/898cabb1-e266-4a59-a793-ef742bd0b479/01_%E0%B8%81%E0%B8%A7%E0%B8%88_55311_291164_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%94%E0%B8%B3%E0%B9%80%E0%B8%99%E0%B8%B4%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%9E%E0%B8%A3%E0%B8%B0%E0%B8%A3%E0%B8%B2%E0%B8%8A%E0%B8%9A%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-898cabb1-e266-4a59-a793-ef742bd0b479-nR-oDEX",
    "https://www.gprocurement.go.th/wps/wcm/connect/c6cb7664-96bd-409c-913b-2de68679c370/04_%E0%B8%81%E0%B8%A7%E0%B8%88_55307_291164_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%A1%E0%B8%B2%E0%B8%95%E0%B8%A3%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B8%84%E0%B8%A7%E0%B8%B2%E0%B8%A1%E0%B8%8A%E0%B9%88%E0%B8%A7%E0%B8%A2%E0%B9%80%E0%B8%AB%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-c6cb7664-96bd-409c-913b-2de68679c370-nSjS1t8",
    "https://www.gprocurement.go.th/wps/wcm/connect/a389a66f-7bb7-4e0e-bb9e-e0135d7b01ff/09_%E0%B8%81%E0%B8%A7%E0%B8%88_55301_291164_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%81%E0%B8%99%E0%B9%89%E0%B8%87%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%82%E0%B8%B1%E0%B8%94%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%87%E0%B8%82%E0%B8%AD%E0%B8%87%E0%B8%A3%E0%B8%B0%E0%B8%9A%E0%B8%9A%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%8B%E0%B8%B7%E0%B9%89%E0%B8%AD%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%A0%E0%B8%B2%E0%B8%84%E0%B8%A3%E0%B8%B1%E0%B8%90%E0%B8%94%E0%B9%89%E0%B8%A7%E0%B8%A2%E0%B8%AD%E0%B8%B4%E0%B9%80%E0%B8%A5%E0%B9%87%E0%B8%81%E0%B8%97%E0%B8%A3%E0%B8%AD%E0%B8%99%E0%B8%B4%E0%B8%81%E0%B8%AA%E0%B9%8C%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-a389a66f-7bb7-4e0e-bb9e-e0135d7b01ff-nUA8ZFe",
    "https://www.gprocurement.go.th/wps/wcm/connect/6f19659f-052c-4451-8ab3-169ce0363828/010_%E0%B8%81%E0%B8%A7%E0%B8%88_55298_291164_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%94%E0%B8%B3%E0%B9%80%E0%B8%99%E0%B8%B4%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%A3%E0%B8%B0%E0%B9%80%E0%B8%9A%E0%B8%B5%E0%B8%A2%E0%B8%9A%E0%B8%AF+%28PDPA%29+.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-6f19659f-052c-4451-8ab3-169ce0363828-p8dgDbR",
    "https://www.gprocurement.go.th/wps/wcm/connect/5bb6ad0f-285e-4373-87aa-d9c7b6fdfa30/07_%E0%B8%81%E0%B8%A7%E0%B8%88_55292_291164_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%A3%E0%B8%93%E0%B8%B5%E0%B9%82%E0%B8%A3%E0%B8%87%E0%B8%9E%E0%B8%A2%E0%B8%B2%E0%B8%9A%E0%B8%B2%E0%B8%A5%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B9%80%E0%B8%AD%E0%B8%81%E0%B8%8A%E0%B8%99%E0%B8%94%E0%B9%8D%E0%B8%B2%E0%B9%80%E0%B8%99%E0%B8%B4%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%95%E0%B8%B4%E0%B8%94%E0%B8%95%E0%B8%B1%E0%B9%89%E0%B8%87%E0%B8%A3%E0%B8%B0%E0%B8%9A%E0%B8%9A%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-5bb6ad0f-285e-4373-87aa-d9c7b6fdfa30-nTmOCwX",
    "https://www.gprocurement.go.th/wps/wcm/connect/da92fb2e-bf4b-4440-9b1f-c9afccec00c0/08_%E0%B8%81%E0%B8%A7%E0%B8%88_55257_291164_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9E%E0%B8%B4%E0%B8%88%E0%B8%B2%E0%B8%A3%E0%B8%93%E0%B8%B2%E0%B8%84%E0%B8%B7%E0%B8%99%E0%B9%80%E0%B8%87%E0%B8%B4%E0%B8%99%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B8%9B%E0%B8%A3%E0%B8%B1%E0%B8%93%E0%B9%83%E0%B8%AB%E0%B9%86%E0%B8%84%E0%B8%B9%E0%B9%88%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-da92fb2e-bf4b-4440-9b1f-c9afccec00c0-nU58B9O",
    "https://www.gprocurement.go.th/wps/wcm/connect/dd361ddd-a071-4dc8-aaa2-093dd64d38dc/05_%E0%B8%81%E0%B8%A7%E0%B8%88_55243_291164_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%82%E0%B8%AD%E0%B8%84%E0%B8%B7%E0%B8%99%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B8%9B%E0%B8%A3%E0%B8%B1%E0%B8%9A%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-dd361ddd-a071-4dc8-aaa2-093dd64d38dc-nSk0IjX",
    "https://www.gprocurement.go.th/wps/wcm/connect/5fb02dee-03e8-4d8e-bf35-48f6efd7ab6b/02_%E0%B8%81%E0%B8%A7%E0%B8%88_55237_291164_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%A1%E0%B8%B2%E0%B8%95%E0%B8%A3%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B8%84%E0%B8%A7%E0%B8%B2%E0%B8%A1%E0%B8%8A%E0%B9%88%E0%B8%A7%E0%B8%A2%E0%B9%80%E0%B8%AB%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-5fb02dee-03e8-4d8e-bf35-48f6efd7ab6b-nSiYssH",
    "https://www.gprocurement.go.th/wps/wcm/connect/36681887-ad22-4253-82f6-7adbdc06b007/03_%E0%B8%81%E0%B8%A7%E0%B8%88_55232_291164_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%A3%E0%B8%93%E0%B8%B5%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%8B%E0%B8%B7%E0%B9%89%E0%B8%AD%E0%B8%9E%E0%B8%B1%E0%B8%AA%E0%B8%94%E0%B8%B8%E0%B8%84%E0%B8%B2%E0%B8%81%E0%B8%A3%E0%B9%89%E0%B8%B2%E0%B8%99%E0%B8%84%E0%B9%89%E0%B8%B2%E0%B9%83%E0%B8%99%E0%B9%80%E0%B8%A7%E0%B9%87%E0%B8%9A%E0%B9%84%E0%B8%8B%E0%B8%95%E0%B9%8C.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-36681887-ad22-4253-82f6-7adbdc06b007-nSjHfcn",
    "https://www.gprocurement.go.th/wps/wcm/connect/0d19202f-54d3-48f2-895a-5ebaac681e08/06_%E0%B8%81%E0%B8%A7%E0%B8%88_55227_291164_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%AB%E0%B8%99%E0%B8%B1%E0%B8%87%E0%B8%AA%E0%B8%B7%E0%B8%AD%E0%B8%84%E0%B8%93%E0%B8%B0%E0%B8%81%E0%B8%A3%E0%B8%A3%E0%B8%A1%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%A7%E0%B8%B4%E0%B8%99%E0%B8%B4%E0%B8%88%E0%B8%89%E0%B8%B1%E0%B8%A2%E0%B8%9B%E0%B8%B1%E0%B8%8D%E0%B8%AB%E0%B8%B2%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-0d19202f-54d3-48f2-895a-5ebaac681e08-nSZ7xq5",
    "https://www.gprocurement.go.th/wps/wcm/connect/c9635566-5792-47cb-b2d9-86643737b278/011_%E0%B8%81%E0%B8%A7%E0%B8%88_55217_291164_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%80%E0%B8%81%E0%B8%B5%E0%B9%88%E0%B8%A2%E0%B8%A7%E0%B8%81%E0%B8%B1%E0%B8%9A%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%81%E0%B8%8E%E0%B8%81%E0%B8%A3%E0%B8%B0%E0%B8%97%E0%B8%A3%E0%B8%A7%E0%B8%87%E0%B8%81%E0%B8%B3%E0%B8%AB%E0%B8%99%E0%B8%94%E0%B8%9E%E0%B8%B1%E0%B8%AA%E0%B8%94%E0%B8%B8%E0%B8%AF+PDPA.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-c9635566-5792-47cb-b2d9-86643737b278-p8dh9OC",
    "https://www.gprocurement.go.th/wps/wcm/connect/32b45648-20d9-4cce-855c-f9daa331becb/02_%E0%B8%81%E0%B8%A7%E0%B8%88_54819_261164_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B9%88%E0%B8%B2%E0%B8%A2%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B8%95%E0%B8%AD%E0%B8%9A%E0%B9%81%E0%B8%97%E0%B8%99%E0%B8%A7%E0%B8%B4%E0%B8%97%E0%B8%A2%E0%B8%B2%E0%B8%81%E0%B8%A3.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-32b45648-20d9-4cce-855c-f9daa331becb-nR-leZa",
    "https://www.gprocurement.go.th/wps/wcm/connect/dfd875cb-b289-4b71-9cff-2655bc3b1fb3/03_%E0%B8%81%E0%B8%A7%E0%B8%88_54811_261164_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%A1%E0%B8%B2%E0%B8%95%E0%B8%A3%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%8A%E0%B9%88%E0%B8%A7%E0%B8%A2%E0%B9%80%E0%B8%AB%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-dfd875cb-b289-4b71-9cff-2655bc3b1fb3-nSOSt4Q",
    "https://www.gprocurement.go.th/wps/wcm/connect/34181c73-a131-4500-884f-7c71f2a9480f/01_%E0%B8%81%E0%B8%A7%E0%B8%88_54808_261164_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%A1%E0%B8%B2%E0%B8%95%E0%B8%A3%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B8%84%E0%B8%A7%E0%B8%B2%E0%B8%A1%E0%B8%8A%E0%B9%88%E0%B8%A7%E0%B8%A2%E0%B9%80%E0%B8%AB%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B8%9B%E0%B8%A3%E0%B8%B0%E0%B8%81%E0%B8%AD%E0%B8%9A%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-34181c73-a131-4500-884f-7c71f2a9480f-nR-hmC3",
    "https://www.gprocurement.go.th/wps/wcm/connect/a706a787-5c41-4cb4-8a6c-8ecea0fd8ee9/03_%E0%B8%81%E0%B8%A7%E0%B8%88_54552_251164_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%82%E0%B8%B2%E0%B8%A2%E0%B9%80%E0%B8%AD%E0%B8%81%E0%B8%AA%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%A3%E0%B8%B0%E0%B8%81%E0%B8%A7%E0%B8%94%E0%B8%A3%E0%B8%B2%E0%B8%84%E0%B8%B2%E0%B8%AD%E0%B8%B4%E0%B9%80%E0%B8%A5%E0%B9%87%E0%B8%81%E0%B8%97%E0%B8%A3%E0%B8%AD%E0%B8%99%E0%B8%B4%E0%B8%81%E0%B8%AA%E0%B9%8C%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-a706a787-5c41-4cb4-8a6c-8ecea0fd8ee9-nSZbCqA",
    "https://www.gprocurement.go.th/wps/wcm/connect/f69cbf28-f462-4395-b513-76aeabbcba03/02%E0%B8%81%E0%B8%A7%E0%B8%88_54541_251164_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%82%E0%B8%AD%E0%B8%84%E0%B8%B7%E0%B8%99%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B8%9B%E0%B8%A3%E0%B8%B1%E0%B8%9A%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-f69cbf28-f462-4395-b513-76aeabbcba03-nSjP81d",
    "https://www.gprocurement.go.th/wps/wcm/connect/2c944762-6352-4f32-b54d-dfa63f87b254/004_%E0%B8%81%E0%B8%A7%E0%B8%88_54533_251164_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%9B%E0%B8%B1%E0%B8%82%E0%B8%AB%E0%B8%B2%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%8B%E0%B8%B7%E0%B9%89%E0%B8%AD%E0%B8%9E%E0%B8%B1%E0%B8%AA%E0%B8%94%E0%B8%B8%E0%B8%AF+PDPA.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-2c944762-6352-4f32-b54d-dfa63f87b254-p8dgGyN",
    "https://www.gprocurement.go.th/wps/wcm/connect/9bcc0a3a-825b-460d-ad93-194529dcfb20/01_%E0%B8%81%E0%B8%A7%E0%B8%88_54523_251164_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%94%E0%B9%8D%E0%B8%B2%E0%B9%80%E0%B8%99%E0%B8%B4%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%80%E0%B8%8A%E0%B9%88%E0%B8%B2%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B8%94%E0%B8%B4%E0%B8%99.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-9bcc0a3a-825b-460d-ad93-194529dcfb20-nSiTAYF",
    "https://www.gprocurement.go.th/wps/wcm/connect/ef8dfcfb-28a4-45a3-ae6a-104c4b65c6fb/04_%E0%B8%81%E0%B8%A7%E0%B8%88_54498_241164_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%B2%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%84%E0%B8%B1%E0%B8%94%E0%B9%80%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B9%81%E0%B8%A5%E0%B8%B0%E0%B8%A7%E0%B9%88%E0%B8%B2%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%9A%E0%B8%A3%E0%B8%B4%E0%B8%A9%E0%B8%B1%E0%B8%97%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-ef8dfcfb-28a4-45a3-ae6a-104c4b65c6fb-nSk5E8I"
]

ctx = ssl.create_default_context()
ctx.check_hostname = False
ctx.verify_mode = ssl.CERT_NONE

print(f"Downloading {len(page_11_links)} files from Page 11 (retry)...")

success = 0
failed = 0
for url in page_11_links:
    try:
        path = urllib.parse.urlparse(url).path
        filename_encoded = os.path.basename(path)
        filename = urllib.parse.unquote(filename_encoded)
        filepath = os.path.join(DOWNLOAD_DIR, filename)
        
        if os.path.exists(filepath):
            print(f"Skip (exists): {filename[:40]}...")
            success += 1
            continue
            
        print(f"DL: {filename[:40]}...")
        req = urllib.request.Request(url, headers={'User-Agent': 'Mozilla/5.0'})
        with urllib.request.urlopen(req, context=ctx, timeout=30) as r, open(filepath, 'wb') as f:
            f.write(r.read())
        success += 1
    except Exception as e:
        print(f"Failed: {filename[:30]}... - {e}")
        failed += 1

print(f"\nPage 11 done. Success: {success}, Failed: {failed}")
print()
print("Counting total files in download directory...")
files = [f for f in os.listdir(DOWNLOAD_DIR) if f.endswith('.pdf')]
print(f"Total PDF files: {len(files)}")
