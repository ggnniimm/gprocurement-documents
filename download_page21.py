
import os
import urllib.request
import urllib.parse
import ssl

DOWNLOAD_DIR = "/Users/mingsaksaengwilaipon/.gemini/antigravity/scratch/gprocurement_downloads"

page_21_links = [
    "https://www.gprocurement.go.th/wps/wcm/connect/a887951a-9fa5-43df-863f-5f42b727ffb0/02_%E0%B8%81%E0%B8%A7%E0%B8%88_24257_280564_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%81%E0%B8%A3%E0%B8%93%E0%B8%B5%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%8B%E0%B8%B7%E0%B9%89%E0%B8%AD%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B8%94%E0%B8%B4%E0%B8%99%E0%B9%82%E0%B8%94%E0%B8%A2%E0%B8%A7%E0%B8%B4%E0%B8%98%E0%B8%B5%E0%B9%80%E0%B8%89%E0%B8%9E%E0%B8%B2%E0%B8%B0%E0%B9%80%E0%B8%88%E0%B8%B2%E0%B8%B0%E0%B8%88%E0%B8%87.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-a887951a-9fa5-43df-863f-5f42b727ffb0-nOn.2SK",
    "https://www.gprocurement.go.th/wps/wcm/connect/3d1ee57c-acc3-48ec-b550-0afaed9ac2ea/01_%E0%B8%81%E0%B8%A7%E0%B8%88_24042_270564_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9E%E0%B8%B4%E0%B8%88%E0%B8%B2%E0%B8%A3%E0%B8%93%E0%B8%B2%E0%B9%80%E0%B8%AD%E0%B8%81%E0%B8%AA%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%A3%E0%B8%B0%E0%B8%81%E0%B8%A7%E0%B8%94%E0%B8%A3%E0%B8%B2%E0%B8%84%E0%B8%B2%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%81%E0%B9%88%E0%B8%AD%E0%B8%AA%E0%B8%A3%E0%B9%89%E0%B8%B2%E0%B8%87.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-3d1ee57c-acc3-48ec-b550-0afaed9ac2ea-nOhlIeB",
    "https://www.gprocurement.go.th/wps/wcm/connect/2d4e6e1b-d47b-4982-98c1-243deac46c7a/01_%E0%B8%81%E0%B8%A7%E0%B8%88_23958_250564_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%81%E0%B8%B3%E0%B8%AB%E0%B8%99%E0%B8%94%E0%B8%A3%E0%B8%B2%E0%B8%84%E0%B8%B2%E0%B8%81%E0%B8%A5%E0%B8%B2%E0%B8%87%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B8%94%E0%B8%B4%E0%B8%99%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%A3%E0%B8%B0%E0%B9%80%E0%B8%9A%E0%B8%B5%E0%B8%A2%E0%B8%9A%E0%B8%81%E0%B8%A3%E0%B8%B0%E0%B8%97%E0%B8%A3%E0%B8%A7%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%84%E0%B8%A5%E0%B8%B1%E0%B8%87%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-2d4e6e1b-d47b-4982-98c1-243deac46c7a-nOnYJQ3",
    "https://www.gprocurement.go.th/wps/wcm/connect/58f5bdac-d5ea-4b1c-a8cf-bc12d5976e66/01_%E0%B8%81%E0%B8%A7%E0%B8%88_23748_240564_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%A1%E0%B8%B2%E0%B8%95%E0%B8%A3%E0%B8%B2+96.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-58f5bdac-d5ea-4b1c-a8cf-bc12d5976e66-nOhOlw-",
    "https://www.gprocurement.go.th/wps/wcm/connect/c466bba6-cb47-4bb9-bc26-335e540d4d80/02_%E0%B8%81%E0%B8%A7%E0%B8%88_23746_240564_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%97%E0%B8%B3%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2%E0%B8%8B%E0%B8%B7%E0%B9%89%E0%B8%AD%E0%B8%82%E0%B8%B2%E0%B8%A2%E0%B8%84%E0%B8%AD%E0%B8%A1%E0%B8%9E%E0%B8%B4%E0%B8%A7%E0%B9%80%E0%B8%95%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B8%97%E0%B8%94%E0%B9%81%E0%B8%97%E0%B8%99.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-c466bba6-cb47-4bb9-bc26-335e540d4d80-nT1YXb3",
    "https://www.gprocurement.go.th/wps/wcm/connect/c94058bc-9d71-4c42-997b-8eee81a3c96f/01_%E0%B8%81%E0%B8%A7%E0%B8%88_23231_200564_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B3%E0%B8%AB%E0%B8%99%E0%B8%94%E0%B8%A3%E0%B8%B2%E0%B8%84%E0%B8%B2%E0%B8%81%E0%B8%A5%E0%B8%B2%E0%B8%87%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B8%94%E0%B8%B4%E0%B8%99%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%A3%E0%B8%B0%E0%B9%80%E0%B8%9A%E0%B8%B5%E0%B8%A2%E0%B8%9A%E0%B8%81%E0%B8%A3%E0%B8%B0%E0%B8%97%E0%B8%A3%E0%B8%A7%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%84%E0%B8%A5%E0%B8%B1%E0%B8%87%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-c94058bc-9d71-4c42-997b-8eee81a3c96f-nXyD3DC",
    "https://www.gprocurement.go.th/wps/wcm/connect/3f1c3d0f-c6cd-4163-bf74-0ea2f0aeb5a3/02_%E0%B8%81%E0%B8%A7%E0%B8%88_23136_200564_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%A5%E0%B8%B0%E0%B8%82%E0%B8%AD%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B8%97%E0%B8%9A%E0%B8%97%E0%B8%A7%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%A3%E0%B8%B0%E0%B9%80%E0%B8%9A%E0%B8%B5%E0%B8%A2%E0%B8%9A%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-3f1c3d0f-c6cd-4163-bf74-0ea2f0aeb5a3-nSNZkwa",
    "https://www.gprocurement.go.th/wps/wcm/connect/427544bf-18b8-465c-b953-d84736923637/05_%E0%B8%81%E0%B8%A7%E0%B8%88_23143_200564_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%9E%E0%B8%A3%E0%B8%B0%E0%B8%A3%E0%B8%B2%E0%B8%8A%E0%B8%9A%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-427544bf-18b8-465c-b953-d84736923637-nT2sXWu",
    "https://www.gprocurement.go.th/wps/wcm/connect/2136eead-83c6-4543-bdb4-a5febef2d1c6/03_%E0%B8%81%E0%B8%A7%E0%B8%88_23141_200564_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%A5%E0%B8%B0%E0%B8%82%E0%B8%AD%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B8%97%E0%B8%9A%E0%B8%97%E0%B8%A7%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%A3%E0%B8%B0%E0%B9%80%E0%B8%9A%E0%B8%B5%E0%B8%A2%E0%B8%9A%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-2136eead-83c6-4543-bdb4-a5febef2d1c6-nSO2-eP",
    "https://www.gprocurement.go.th/wps/wcm/connect/a969e72b-c22b-4fd9-83ff-5dbb6a6aa407/04_%E0%B8%81%E0%B8%A7%E0%B8%88_23133_200564_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%94%E0%B9%8D%E0%B8%B2%E0%B9%80%E0%B8%99%E0%B8%B4%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%83%E0%B8%99%E0%B8%8A%E0%B9%88%E0%B8%A7%E0%B8%87%E0%B9%80%E0%B8%A7%E0%B8%A5%E0%B8%B2%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B9%84%E0%B8%94%E0%B9%89%E0%B8%A3%E0%B8%B1%E0%B8%9A%E0%B8%9C%E0%B8%A5%E0%B8%81%E0%B8%A3%E0%B8%B0%E0%B8%97%E0%B8%9A%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-a969e72b-c22b-4fd9-83ff-5dbb6a6aa407-nT2j59s",
    "https://www.gprocurement.go.th/wps/wcm/connect/63f9a435-6bd2-49c7-996b-fee8efa5bd09/01_%E0%B8%81%E0%B8%A7%E0%B8%88_22934_190564_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%A1%E0%B8%AD%E0%B8%9A%E0%B8%AD%E0%B8%B3%E0%B8%99%E0%B8%B2%E0%B8%88%E0%B9%83%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%8B%E0%B8%B7%E0%B9%89%E0%B8%AD%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-63f9a435-6bd2-49c7-996b-fee8efa5bd09-nOhHyI4",
    "https://www.gprocurement.go.th/wps/wcm/connect/ba18ab66-1ebb-4d0f-be93-3e7101b7e81f/02_%E0%B8%81%E0%B8%A7%E0%B8%88_22623_180564_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%97%E0%B8%B3%E0%B8%A3%E0%B8%B2%E0%B8%84%E0%B8%B2%E0%B8%81%E0%B8%A5%E0%B8%B2%E0%B8%87%E0%B8%AA%E0%B8%B3%E0%B8%AB%E0%B8%A3%E0%B8%B1%E0%B8%9A%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B8%9B%E0%B8%A3%E0%B8%B6%E0%B8%81%E0%B8%A9%E0%B8%B2%E0%B8%95%E0%B9%88%E0%B8%B2%E0%B8%87%E0%B8%9B%E0%B8%A3%E0%B8%B0%E0%B9%80%E0%B8%97%E0%B8%A8.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-ba18ab66-1ebb-4d0f-be93-3e7101b7e81f-nXyCfmH",
    "https://www.gprocurement.go.th/wps/wcm/connect/c9234be4-a993-4ef1-888d-bd13042d6c8b/01_%E0%B8%81%E0%B8%A7%E0%B8%88_22612_180564_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B8%AA%E0%B8%AD%E0%B8%9A%E0%B8%9B%E0%B8%B1%E0%B8%8D%E0%B8%8A%E0%B8%B5%E0%B8%A3%E0%B8%B0%E0%B8%A2%E0%B8%B0%E0%B9%80%E0%B8%A7%E0%B8%A5%E0%B8%B2%E0%B8%95%E0%B8%B4%E0%B8%94%E0%B8%95%E0%B9%88%E0%B8%AD%E0%B8%81%E0%B8%B1%E0%B8%99%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-c9234be4-a993-4ef1-888d-bd13042d6c8b-nOhya3a",
    "https://www.gprocurement.go.th/wps/wcm/connect/c84c60a6-b27d-4904-a539-97743f1abe8f/04_%E0%B8%81%E0%B8%A7%E0%B8%88_22628_180564_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%94%E0%B8%B3%E0%B9%80%E0%B8%99%E0%B8%B4%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%AB%E0%B8%A5%E0%B8%B1%E0%B8%81%E0%B8%81%E0%B8%8E%E0%B8%AB%E0%B8%A1%E0%B8%B2%E0%B8%A2%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-c84c60a6-b27d-4904-a539-97743f1abe8f-nT2ffSw",
    "https://www.gprocurement.go.th/wps/wcm/connect/a533d066-6d14-4150-b6ff-03e31f25889f/03_%E0%B8%81%E0%B8%A7%E0%B8%88_22622_180564_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%8B%E0%B8%B7%E0%B9%89%E0%B8%AD%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%9E%E0%B8%A3%E0%B8%B0%E0%B8%A3%E0%B8%B2%E0%B8%8A%E0%B8%9A%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%8B%E0%B8%B7%E0%B9%89%E0%B8%AD%E0%B8%88%E0%B8%B1%E0%B8%94%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-a533d066-6d14-4150-b6ff-03e31f25889f-nOnZxA0",
    "https://www.gprocurement.go.th/wps/wcm/connect/929381ae-89aa-46ea-95dc-6b35dcc038f2/05_%E0%B8%81%E0%B8%A7%E0%B8%88_22530_180564_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%87%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B8%AA%E0%B8%AD%E0%B8%9A%E0%B8%9B%E0%B8%B1%E0%B8%8D%E0%B8%8A%E0%B8%B5%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-929381ae-89aa-46ea-95dc-6b35dcc038f2-nT2hjvq",
    "https://www.gprocurement.go.th/wps/wcm/connect/a7732c27-bd08-4aa6-9198-d18aaab29bdb/01_%E0%B8%81%E0%B8%A7%E0%B8%88_22300_170564_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%A3%E0%B8%B0%E0%B9%80%E0%B8%9A%E0%B8%B5%E0%B8%A2%E0%B8%9A%E0%B8%81%E0%B8%A3%E0%B8%B0%E0%B8%97%E0%B8%A3%E0%B8%A7%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%84%E0%B8%A5%E0%B8%B1%E0%B8%87%E0%B8%AF.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-a7732c27-bd08-4aa6-9198-d18aaab29bdb-nQD.b02",
    "https://www.gprocurement.go.th/wps/wcm/connect/ba59bce7-077d-434f-9ee8-bb8db416cf72/02_%E0%B8%81%E0%B8%A7%E0%B8%88_22293_170564_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%A3%E0%B8%93%E0%B8%B5%E0%B8%A7%E0%B8%B1%E0%B8%AA%E0%B8%94%E0%B8%B8%E0%B8%82%E0%B8%B8%E0%B8%94%E0%B8%A5%E0%B8%AD%E0%B8%81%E0%B9%80%E0%B8%9B%E0%B8%A5%E0%B8%B5%E0%B9%88%E0%B8%A2%E0%B8%99%E0%B9%81%E0%B8%9B%E0%B8%A5%E0%B8%87%E0%B8%81%E0%B9%88%E0%B8%AD%E0%B8%99%E0%B8%A5%E0%B8%87%E0%B8%99%E0%B8%B2%E0%B8%A1%E0%B8%93%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-ba59bce7-077d-434f-9ee8-bb8db416cf72-nXCWhUA",
    "https://www.gprocurement.go.th/wps/wcm/connect/ef8666ef-0ce5-4ee5-b45a-aad71c0ad34b/01_%E0%B8%81%E0%B8%A7%E0%B8%88_22116_140564_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%A3%E0%B8%25...%25.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-ef8666ef-0ce5-4ee5-b45a-aad71c0ad34b-nSNSeZZ",
    "https://www.gprocurement.go.th/wps/wcm/connect/13838a3e-c09d-4daa-9dc3-db74f03f1845/01_%E0%B8%81%E0%B8%A7%E0%B8%88_21733_130564_%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9A%E0%B8%A3%E0%B8%B4%E0%B8%AB%E0%B8%B2%E0%B8%AA%E0%B8%B1%E0%B8%8D%E0%B8%8D%E0%B8%B2.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-13838a3e-c09d-4daa-9dc3-db74f03f1845-nXCVFHH"
]

ctx = ssl.create_default_context()
ctx.check_hostname = False
ctx.verify_mode = ssl.CERT_NONE

print(f"Downloading {len(page_21_links)} files from Page 21...")

success = 0
failed = 0
for url in page_21_links:
    try:
        path = urllib.parse.urlparse(url).path
        filename_encoded = os.path.basename(path)
        filename = urllib.parse.unquote(filename_encoded)
        
        # Simple sanitization
        filename = filename.replace('\ufe6f', '').replace('%EF%B9%AF', '')
        
        filepath = os.path.join(DOWNLOAD_DIR, filename)
        
        if os.path.exists(filepath):
            print(f"Skip (exists): {filename[:40]}...")
            success += 1
            continue
            
        print(f"DL: {filename[:40]}...")
        req = urllib.request.Request(url, headers={'User-Agent': 'Mozilla/5.0'})
        with urllib.request.urlopen(req, context=ctx, timeout=30) as r, open(filepath, 'wb') as f:
            f.write(r.read())
        success += 1
    except Exception as e:
        print(f"Failed: {filename[:30]}... - {e}")
        failed += 1

print(f"\nPage 21 done. Success: {success}, Failed: {failed}")
print()
print("Counting total files in download directory...")
files = [f for f in os.listdir(DOWNLOAD_DIR) if f.endswith('.pdf')]
print(f"Total PDF files: {len(files)}")
